!function(){function t(t){return t&&t.__esModule?t.default:t}var e,n,i,r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o={},s=e={};function a(){throw new Error("setTimeout has not been defined")}function l(){throw new Error("clearTimeout has not been defined")}function c(t){if(n===setTimeout)return setTimeout(t,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(t){n=a}try{i="function"==typeof clearTimeout?clearTimeout:l}catch(t){i=l}}();var u,h=[],f=!1,d=-1;function p(){f&&u&&(f=!1,u.length?h=u.concat(h):d=-1,h.length&&y())}function y(){if(!f){var t=c(p);f=!0;for(var e=h.length;e;){for(u=h,h=[];++d<e;)u&&u[d].run();d=-1,e=h.length}u=null,f=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===l||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function m(t,e){this.fun=t,this.array=e}function g(){}s.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new m(t,e)),1!==h.length||f||c(y)},m.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=g,s.addListener=g,s.once=g,s.off=g,s.removeListener=g,s.removeAllListeners=g,s.emit=g,s.prependListener=g,s.prependOnceListener=g,s.listeners=function(t){return[]},s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0};var v,b=!1;function w(){var t,e;return b||(b=!0,t=v={},e=function(){return function(){function t(t,e){if(this.app="loki",this.options=e||{},void 0!==t&&(this.app=t),this.catalog=null,!this.checkAvailability())throw new Error("indexedDB does not seem to be supported for your environment")}function e(t){this.db=null,this.initializeLokiCatalog(t)}return t.prototype.closeDatabase=function(){this.catalog&&this.catalog.db&&(this.catalog.db.close(),this.catalog.db=null)},t.prototype.checkAvailability=function(){return!("undefined"==typeof indexedDB||!indexedDB)},t.prototype.loadDatabase=function(t,n){var i=this.app,r=this;null!==this.catalog&&null!==this.catalog.db?this.catalog.getAppKey(i,t,(function(t){if("function"==typeof n){if(0===t.id)return void n(null);n(t.val)}else console.log(t.val)})):this.catalog=new e((function(e){r.catalog=e,r.loadDatabase(t,n)}))},t.prototype.loadKey=t.prototype.loadDatabase,t.prototype.saveDatabase=function(t,n,i){var r=this.app,o=this;function s(t){t&&!0===t.success?i(null):i(new Error("Error saving database")),o.options.closeAfterSave&&o.closeDatabase()}null!==this.catalog&&null!==this.catalog.db?this.catalog.setAppKey(r,t,n,s):this.catalog=new e((function(e){o.saveDatabase(t,n,s)}))},t.prototype.saveKey=t.prototype.saveDatabase,t.prototype.deleteDatabase=function(t,n){var i=this.app,r=this;null!==this.catalog&&null!==this.catalog.db?this.catalog.getAppKey(i,t,(function(t){var e=t.id;0!==e?r.catalog.deleteAppKey(e,n):"function"==typeof n&&n({success:!0})})):this.catalog=new e((function(e){r.catalog=e,r.deleteDatabase(t,n)}))},t.prototype.deleteKey=t.prototype.deleteDatabase,t.prototype.deleteDatabasePartitions=function(t){var e=this;this.getDatabaseList((function(n){n.forEach((function(n){n.startsWith(t)&&e.deleteDatabase(n)}))}))},t.prototype.getDatabaseList=function(t){var n=this.app,i=this;null!==this.catalog&&null!==this.catalog.db?this.catalog.getAppKeys(n,(function(e){for(var n=[],i=0;i<e.length;i++)n.push(e[i].key);"function"==typeof t?t(n):n.forEach((function(t){console.log(t)}))})):this.catalog=new e((function(e){i.catalog=e,i.getDatabaseList(t)}))},t.prototype.getKeyList=t.prototype.getDatabaseList,t.prototype.getCatalogSummary=function(t){this.app;var n=this;null!==this.catalog&&null!==this.catalog.db?this.catalog.getAllKeys((function(e){for(var n,i,r,o,s,a=[],l=0;l<e.length;l++)r=(n=e[l]).app||"",o=n.key||"",s=n.val||"",i=2*r.length+2*o.length+s.length+1,a.push({app:n.app,key:n.key,size:i});"function"==typeof t?t(a):a.forEach((function(t){console.log(t)}))})):this.catalog=new e((function(e){n.catalog=e,n.getCatalogSummary(t)}))},e.prototype.initializeLokiCatalog=function(t){var e=indexedDB.open("LokiCatalog",1),n=this;e.onupgradeneeded=function(t){var e=t.target.result;if(e.objectStoreNames.contains("LokiAKV")&&e.deleteObjectStore("LokiAKV"),!e.objectStoreNames.contains("LokiAKV")){var n=e.createObjectStore("LokiAKV",{keyPath:"id",autoIncrement:!0});n.createIndex("app","app",{unique:!1}),n.createIndex("key","key",{unique:!1}),n.createIndex("appkey","appkey",{unique:!0})}},e.onsuccess=function(e){n.db=e.target.result,"function"==typeof t&&t(n)},e.onerror=function(t){throw t}},e.prototype.getAppKey=function(t,e,n){var i,r=t+","+e,o=this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").index("appkey").get(r);o.onsuccess=(i=n,function(t){var e=t.target.result;null==e&&(e={id:0,success:!1}),"function"==typeof i?i(e):console.log(e)}),o.onerror=function(t){return function(e){if("function"!=typeof t)throw e;t({id:0,success:!1})}}(n)},e.prototype.getAppKeyById=function(t,e,n){this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").get(t).onsuccess=function(t,e){return function(n){"function"==typeof e?e(n.target.result,t):console.log(n.target.result)}}(n,e)},e.prototype.setAppKey=function(t,e,n,i){var r,o=this.db.transaction(["LokiAKV"],"readwrite").objectStore("LokiAKV"),s=o.index("appkey"),a=t+","+e,l=s.get(a);l.onsuccess=function(r){var s=r.target.result;null==s?s={app:t,key:e,appkey:t+","+e,val:n}:s.val=n;var a,c=o.put(s);c.onerror=(a=i,function(t){"function"==typeof a?a({success:!1}):(console.error("LokiCatalog.setAppKey (set) onerror"),console.error(l.error))}),c.onsuccess=function(t){return function(e){"function"==typeof t&&t({success:!0})}}(i)},l.onerror=(r=i,function(t){"function"==typeof r?r({success:!1}):(console.error("LokiCatalog.setAppKey (get) onerror"),console.error(l.error))})},e.prototype.deleteAppKey=function(t,e){var n,i=this.db.transaction(["LokiAKV"],"readwrite").objectStore("LokiAKV").delete(t);i.onsuccess=(n=e,function(t){"function"==typeof n&&n({success:!0})}),i.onerror=function(t){return function(e){"function"==typeof t?t({success:!1}):(console.error("LokiCatalog.deleteAppKey raised onerror"),console.error(i.error))}}(e)},e.prototype.getAppKeys=function(t,e){var n,i=this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").index("app"),r=IDBKeyRange.only(t),o=i.openCursor(r);o.onsuccess=function(t,e){return function(n){var i=n.target.result;if(i){var r=i.value;t.push(r),i.continue()}else"function"==typeof e?e(t):console.log(t)}}([],e),o.onerror=(n=e,function(t){"function"==typeof n?n(null):(console.error("LokiCatalog.getAppKeys raised onerror"),console.error(t))})},e.prototype.getAllKeys=function(t){var e,n=this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").openCursor();n.onsuccess=function(t,e){return function(n){var i=n.target.result;if(i){var r=i.value;t.push(r),i.continue()}else"function"==typeof e?e(t):console.log(t)}}([],t),n.onerror=(e=t,function(t){"function"==typeof e&&e(null)})},t}()},"object"==typeof v?v=e():t.LokiIndexedAdapter=e()),v}var O,S,I=!1;O=o,S=function(){return function(){var t=Object.prototype.hasOwnProperty,n={copyProperties:function(t,e){var n;for(n in t)e[n]=t[n]},resolveTransformObject:function(t,e,i){var r,o;if("number"!=typeof i&&(i=0),++i>=10)return t;for(r in t)"string"==typeof t[r]&&0===t[r].indexOf("[%lktxp]")?(o=t[r].substring(8),e.hasOwnProperty(o)&&(t[r]=e[o])):"object"==typeof t[r]&&(t[r]=n.resolveTransformObject(t[r],e,i));return t},resolveTransformParams:function(t,e){var i,r,o=[];if(void 0===e)return t;for(i=0;i<t.length;i++)r=p(t[i],"shallow-recurse-objects"),o.push(n.resolveTransformObject(r,e));return o},getIn:function(t,e,n){if(null!=t){if(!n)return t[e];if("string"==typeof e&&(e=e.split(".")),!Array.isArray(e))throw new Error("path must be a string or array. Found "+typeof e);for(var i=0,r=e.length;null!=t&&i<r;)t=t[e[i++]];return i&&i==r?t:void 0}}},i={aeq:o,lt:s,gt:a};function o(t,e){var n,i,r,o;if(t===e)return!0;if(!t||!e||!0===t||!0===e||t!=t||e!=e){switch(t){case void 0:case null:r=1;break;case!1:r=3;break;case!0:r=4;break;case"":r=5;break;default:r=t==t?9:0}switch(e){case void 0:case null:o=1;break;case!1:o=3;break;case!0:o=4;break;case"":o=5;break;default:o=e==e?9:0}if(9!==r||9!==o)return r===o}return n=Number(t),i=Number(e),n==n||i==i?n===i:(n=t.toString())==(i=e.toString())}function s(t,e,n){var i,r,o,s;if(!t||!e||!0===t||!0===e||t!=t||e!=e){switch(t){case void 0:case null:o=1;break;case!1:o=3;break;case!0:o=4;break;case"":o=5;break;default:o=t==t?9:0}switch(e){case void 0:case null:s=1;break;case!1:s=3;break;case!0:s=4;break;case"":s=5;break;default:s=e==e?9:0}if(9!==o||9!==s)return o===s?n:o<s}return i=Number(t),r=Number(e),i==i&&r==r?i<r||!(i>r)&&n:i==i&&r!=r||(r!=r||i==i)&&(t<e||!(t>e)&&(t==e?n:(i=t.toString())<(r=e.toString())||i==r&&n))}function a(t,e,n){var i,r,o,s;if(!t||!e||!0===t||!0===e||t!=t||e!=e){switch(t){case void 0:case null:o=1;break;case!1:o=3;break;case!0:o=4;break;case"":o=5;break;default:o=t==t?9:0}switch(e){case void 0:case null:s=1;break;case!1:s=3;break;case!0:s=4;break;case"":s=5;break;default:s=e==e?9:0}if(9!==o||9!==s)return o===s?n:o>s}return i=Number(t),r=Number(e),i==i&&r==r?i>r||!(i<r)&&n:(i!=i||r==r)&&(r==r&&i!=i||t>e||!(t<e)&&(t==e?n:(i=t.toString())>(r=e.toString())||i==r&&n))}function l(t,e,n){return i.aeq(t,e)?0:i.lt(t,e,!1)?n?1:-1:i.gt(t,e,!1)?n?-1:1:0}function c(t,e,n,i,r){var o,s=r||0,a=e[s],l=!1;if("object"==typeof t&&a in t&&(o=t[a]),s+1>=e.length)l=n(o,i);else if(Array.isArray(o))for(var u=0,h=o.length;u<h&&!0!==(l=c(o[u],e,n,i,s+1));u+=1);else l=c(o,e,n,i,s+1);return l}function u(e){return"string"==typeof e||Array.isArray(e)?function(t){return-1!==e.indexOf(t)}:"object"==typeof e&&null!==e?function(n){return t.call(e,n)}:null}function h(e,n){for(var i in n)if(t.call(n,i))return f[i](e,n[i]);return!1}var f={$eq:function(t,e){return t===e},$aeq:function(t,e){return t==e},$ne:function(t,e){return e!=e?t==t:t!==e},$dteq:function(t,e){return i.aeq(t,e)},$gt:function(t,e){return i.gt(t,e,!1)},$gte:function(t,e){return i.gt(t,e,!0)},$lt:function(t,e){return i.lt(t,e,!1)},$lte:function(t,e){return i.lt(t,e,!0)},$jgt:function(t,e){return t>e},$jgte:function(t,e){return t>=e},$jlt:function(t,e){return t<e},$jlte:function(t,e){return t<=e},$between:function(t,e){return null!=t&&i.gt(t,e[0],!0)&&i.lt(t,e[1],!0)},$jbetween:function(t,e){return null!=t&&t>=e[0]&&t<=e[1]},$in:function(t,e){return-1!==e.indexOf(t)},$nin:function(t,e){return-1===e.indexOf(t)},$keyin:function(t,e){return t in e},$nkeyin:function(t,e){return!(t in e)},$definedin:function(t,e){return void 0!==e[t]},$undefinedin:function(t,e){return void 0===e[t]},$regex:function(t,e){return e.test(t)},$containsString:function(t,e){return"string"==typeof t&&-1!==t.indexOf(e)},$containsNone:function(t,e){return!f.$containsAny(t,e)},$containsAny:function(t,e){var n=u(t);return null!==n&&(Array.isArray(e)?e.some(n):n(e))},$contains:function(t,e){var n=u(t);return null!==n&&(Array.isArray(e)?e.every(n):n(e))},$elemMatch:function(t,e){return!!Array.isArray(t)&&t.some((function(t){return Object.keys(e).every((function(n){var i=e[n];return"object"==typeof i&&i||(i={$eq:i}),-1!==n.indexOf(".")?c(t,n.split("."),h,e[n]):h(t[n],i)}))}))},$type:function(t,e){var n=typeof t;return"object"===n&&(Array.isArray(t)?n="array":t instanceof Date&&(n="date")),"object"!=typeof e?n===e:h(n,e)},$finite:function(t,e){return e===isFinite(t)},$size:function(t,e){return!!Array.isArray(t)&&("object"!=typeof e?t.length===e:h(t.length,e))},$len:function(t,e){return"string"==typeof t&&("object"!=typeof e?t.length===e:h(t.length,e))},$where:function(t,e){return!0===e(t)},$not:function(t,e){return!h(t,e)},$and:function(t,e){for(var n=0,i=e.length;n<i;n+=1)if(!h(t,e[n]))return!1;return!0},$or:function(t,e){for(var n=0,i=e.length;n<i;n+=1)if(h(t,e[n]))return!0;return!1},$exists:function(t,e){return e?void 0!==t:void 0===t}},d={$eq:f.$eq,$aeq:!0,$dteq:!0,$gt:!0,$gte:!0,$lt:!0,$lte:!0,$in:!0,$between:!0};function p(t,e){if(null==t)return null;var n;switch(e||"parse-stringify"){case"parse-stringify":n=JSON.parse(JSON.stringify(t));break;case"jquery-extend-deep":n=jQuery.extend(!0,{},t);break;case"shallow":n=Object.create(t.constructor.prototype),Object.keys(t).map((function(e){n[e]=t[e]}));break;case"shallow-assign":n=Object.create(t.constructor.prototype),Object.assign(n,t);break;case"shallow-recurse-objects":n=p(t,"shallow"),Object.keys(t).forEach((function(e){"object"==typeof t[e]&&"Object"===t[e].constructor.name?n[e]=p(t[e],"shallow-recurse-objects"):Array.isArray(t[e])&&(n[e]=function(t,e){if("parse-stringify"==e)return p(t,e);for(var n=[],i=0,r=t.length;i<r;i++)n[i]=p(t[i],e);return n}(t[e],"shallow-recurse-objects"))}))}return n}function y(){try{return window&&void 0!==window.localStorage&&null!==window.localStorage}catch(t){return!1}}function m(){}function g(t,n){this.filename=t||"loki.db",this.collections=[],this.databaseVersion=1.5,this.engineVersion=1.5,this.autosave=!1,this.autosaveInterval=5e3,this.autosaveHandle=null,this.throttledSaves=!0,this.options={},this.persistenceMethod=null,this.persistenceAdapter=null,this.throttledSavePending=!1,this.throttledCallbacks=[],this.verbose=!(!n||!n.hasOwnProperty("verbose"))&&n.verbose,this.events={init:[],loaded:[],flushChanges:[],close:[],changes:[],warning:[]},n&&n.hasOwnProperty("env")?this.ENV=n.env:this.ENV=void 0!==r&&(r.android||r.NSObject)?"NATIVESCRIPT":"undefined"==typeof window||void 0!==r&&r.window&&void 0!==e?"NODEJS":"undefined"!=typeof document?-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")?"CORDOVA":"BROWSER":"CORDOVA","undefined"===this.ENV&&(this.ENV="NODEJS"),this.configureOptions(n,!0),this.on("init",this.clearChanges)}function v(t){this.hashStore={},this.options=t||{},this.options.hasOwnProperty("asyncResponses")||(this.options.asyncResponses=!1),this.options.hasOwnProperty("asyncTimeout")||(this.options.asyncTimeout=50)}function b(t,e){if(this.mode="reference",this.adapter=null,this.options=e||{},this.dbref=null,this.dbname="",this.pageIterator={},!t)throw new Error("LokiPartitioningAdapter requires a (non-reference mode) adapter on construction");if("reference"===t.mode)throw new Error("LokiPartitioningAdapter cannot be instantiated with a reference mode adapter");this.adapter=t,this.options.hasOwnProperty("paging")||(this.options.paging=!1),this.options.hasOwnProperty("pageSize")||(this.options.pageSize=26214400),this.options.hasOwnProperty("delimiter")||(this.options.delimiter="$<\n")}function O(){try{this.fs=(I||(I=!0),{})}catch(t){this.fs=null}}function S(){}function P(t,e){return e=e||{},this.collection=t,this.filteredrows=[],this.filterInitialized=!1,this}function C(t,e,n){this.collection=t,this.name=e,this.rebuildPending=!1,this.options=n||{},this.options.hasOwnProperty("persistent")||(this.options.persistent=!1),this.options.hasOwnProperty("sortPriority")||(this.options.sortPriority="passive"),this.options.hasOwnProperty("minRebuildInterval")||(this.options.minRebuildInterval=1),this.resultset=new P(t),this.resultdata=[],this.resultsdirty=!1,this.cachedresultset=null,this.filterPipeline=[],this.sortFunction=null,this.sortCriteria=null,this.sortCriteriaSimple=null,this.sortDirty=!1,this.events={rebuild:[]}}function k(e,n){this.name=e,this.data=[],this.idIndex=[],this.binaryIndices={},this.constraints={unique:{},exact:{}},this.uniqueNames=[],this.transforms={},this.objType=e,this.dirty=!0,this.cachedIndex=null,this.cachedBinaryIndex=null,this.cachedData=null;var i=this;(n=n||{}).hasOwnProperty("unique")&&(Array.isArray(n.unique)||(n.unique=[n.unique]),n.unique.forEach((function(t){i.uniqueNames.push(t),i.constraints.unique[t]=new N(t)}))),n.hasOwnProperty("exact")&&n.exact.forEach((function(t){i.constraints.exact[t]=new _(t)})),this.adaptiveBinaryIndices=!n.hasOwnProperty("adaptiveBinaryIndices")||n.adaptiveBinaryIndices,this.transactional=!!n.hasOwnProperty("transactional")&&n.transactional,this.cloneObjects=!!n.hasOwnProperty("clone")&&n.clone,this.cloneMethod=n.hasOwnProperty("cloneMethod")?n.cloneMethod:"parse-stringify",this.asyncListeners=!!n.hasOwnProperty("asyncListeners")&&n.asyncListeners,this.disableMeta=!!n.hasOwnProperty("disableMeta")&&n.disableMeta,this.disableChangesApi=!n.hasOwnProperty("disableChangesApi")||n.disableChangesApi,this.disableDeltaChangesApi=!n.hasOwnProperty("disableDeltaChangesApi")||n.disableDeltaChangesApi,this.disableChangesApi&&(this.disableDeltaChangesApi=!0),this.autoupdate=!!n.hasOwnProperty("autoupdate")&&n.autoupdate,this.serializableIndices=!n.hasOwnProperty("serializableIndices")||n.serializableIndices,this.ttl={age:null,ttlInterval:null,daemon:null},this.setTTL(n.ttl||-1,n.ttlInterval),this.maxId=0,this.DynamicViews=[],this.events={insert:[],update:[],"pre-insert":[],"pre-update":[],close:[],flushbuffer:[],error:[],delete:[],warning:[]},this.changes=[],this.dirtyIds=[],this.ensureId();var r=[];if(n&&n.indices)if("[object Array]"===Object.prototype.toString.call(n.indices))r=n.indices;else{if("string"!=typeof n.indices)throw new TypeError("Indices needs to be a string or an array of strings");r=[n.indices]}for(var o=0;o<r.length;o++)this.ensureIndex(r[o]);function s(t,e){var n=null!==e&&"object"==typeof e?Object.keys(e):null;if(n&&n.length&&["string","boolean","number"].indexOf(typeof e)<0){for(var r={},o=0;o<n.length;o++){var a=n[o];if(e.hasOwnProperty(a))if(!t.hasOwnProperty(a)||i.uniqueNames.indexOf(a)>=0||"$loki"==a||"meta"==a)r[a]=e[a];else{var l=s(t[a],e[a]);void 0!==l&&l!={}&&(r[a]=l)}}return 0===Object.keys(r).length?void 0:r}return t===e?void 0:e}function a(){i.changes=[]}this.observerCallback=function(e){var n="function"==typeof Set?new Set:[];n.add||(n.add=function(t){return-1===this.indexOf(t)&&this.push(t),this}),e.forEach((function(t){n.add(t.object)})),n.forEach((function(e){if(!t.call(e,"$loki"))return i.removeAutoUpdateObserver(e);try{i.update(e)}catch(t){}}))},this.getChangeDelta=function(t,e){return e?s(e,t):JSON.parse(JSON.stringify(t))},this.getObjectDelta=s,this.getChanges=function(){return i.changes},this.flushChanges=a,this.setChangesApi=function(t){i.disableChangesApi=!t,t||(i.disableDeltaChangesApi=!1)},this.on("delete",(function(t){i.disableChangesApi||i.createChange(i.name,"R",t)})),this.on("warning",(function(t){i.lokiConsoleWrapper.warn(t)})),a()}function x(t){return-1!==t.indexOf(".")}function A(t){return parseFloat(t,10)}function D(t,e){return t+e}function T(t,e){return t-e}function j(t){return t.reduce(D,0)/t.length}function M(t,e,n){if(!1===n)return t[e];for(var i=e.split("."),r=t;i.length>0;)r=r[i.shift()];return r}function E(t,e,n){for(var i,r,o=0,s=t.length;o<s;){if(r=o+s>>1,0===(i=n.apply(null,[e,t[r]])))return{found:!0,index:r};i<0?s=r:o=r+1}return{found:!1,index:s}}function q(t){return function(e,n){return E(e,n,t)}}function R(){}function N(t){this.field=t,this.keyMap={},this.lokiMap={}}function _(t){this.index={},this.field=t}return m.prototype.events={},m.prototype.asyncListeners=!1,m.prototype.on=function(t,e){var n,i=this;return Array.isArray(t)?(t.forEach((function(t){i.on(t,e)})),e):((n=this.events[t])||(n=this.events[t]=[]),n.push(e),e)},m.prototype.emit=function(t){var e=this,n=Array.prototype.slice.call(arguments,1);if(!t||!this.events[t])throw new Error("No event "+t+" defined");this.events[t].forEach((function(t){e.asyncListeners?setTimeout((function(){t.apply(e,n)}),1):t.apply(e,n)}))},m.prototype.addListener=m.prototype.on,m.prototype.removeListener=function(t,e){var n=this;if(Array.isArray(t))t.forEach((function(t){n.removeListener(t,e)}));else if(this.events[t]){var i=this.events[t];i.splice(i.indexOf(e),1)}},g.prototype=new m,g.prototype.constructor=g,g.prototype.getIndexedAdapter=function(){return w()},g.prototype.configureOptions=function(t,e){var n={fs:O,localStorage:S,memory:v};if(this.options={},this.persistenceMethod=null,this.persistenceAdapter=null,void 0!==t){if(this.options=t,this.options.hasOwnProperty("persistenceMethod")&&"function"==typeof n[t.persistenceMethod]&&(this.persistenceMethod=t.persistenceMethod,this.persistenceAdapter=new n[t.persistenceMethod]),this.options.hasOwnProperty("adapter")&&(this.persistenceMethod="adapter",this.persistenceAdapter=t.adapter,this.options.adapter=null,this.isIncremental="incremental"===this.persistenceAdapter.mode),t.autoload&&e){var i=this;setTimeout((function(){i.loadDatabase(t,t.autoloadCallback)}),1)}this.options.hasOwnProperty("autosaveInterval")&&(this.autosaveDisable(),this.autosaveInterval=parseInt(this.options.autosaveInterval,10)),this.options.hasOwnProperty("autosave")&&this.options.autosave&&(this.autosaveDisable(),this.autosave=!0,this.options.hasOwnProperty("autosaveCallback")?this.autosaveEnable(t,t.autosaveCallback):this.autosaveEnable()),this.options.hasOwnProperty("throttledSaves")&&(this.throttledSaves=this.options.throttledSaves)}this.options.hasOwnProperty("serializationMethod")||(this.options.serializationMethod="normal"),this.options.hasOwnProperty("destructureDelimiter")||(this.options.destructureDelimiter="$<\n"),null===this.persistenceAdapter&&(this.persistenceMethod={NODEJS:"fs",BROWSER:"localStorage",CORDOVA:"localStorage",MEMORY:"memory"}[this.ENV],this.persistenceMethod&&(this.persistenceAdapter=new n[this.persistenceMethod]))},g.prototype.copy=function(t){var e,n,i=new g(this.filename,{env:"NA"});if(t=t||{},i.loadJSONObject(this,{retainDirtyFlags:!0}),t.hasOwnProperty("removeNonSerializable")&&!0===t.removeNonSerializable)for(i.autosaveHandle=null,i.persistenceAdapter=null,e=i.collections.length,n=0;n<e;n++)i.collections[n].constraints=null,i.collections[n].ttl=null;return i},g.prototype.addCollection=function(t,e){var n,i=this.collections.length;if(e&&!0===e.disableMeta){if(!1===e.disableChangesApi)throw new Error("disableMeta option cannot be passed as true when disableChangesApi is passed as false");if(!1===e.disableDeltaChangesApi)throw new Error("disableMeta option cannot be passed as true when disableDeltaChangesApi is passed as false");if("number"==typeof e.ttl&&e.ttl>0)throw new Error("disableMeta option cannot be passed as true when ttl is enabled")}for(n=0;n<i;n+=1)if(this.collections[n].name===t)return this.collections[n];var r=new k(t,e);return r.isIncremental=this.isIncremental,this.collections.push(r),this.verbose&&(r.lokiConsoleWrapper=console),r},g.prototype.loadCollection=function(t){if(!t.name)throw new Error("Collection must have a name property to be loaded");this.collections.push(t)},g.prototype.getCollection=function(t){var e,n=this.collections.length;for(e=0;e<n;e+=1)if(this.collections[e].name===t)return this.collections[e];return this.emit("warning","collection "+t+" not found"),null},g.prototype.renameCollection=function(t,e){var n=this.getCollection(t);return n&&(n.name=e),n},g.prototype.listCollections=function(){for(var t=this.collections.length,e=[];t--;)e.push({name:this.collections[t].name,type:this.collections[t].objType,count:this.collections[t].data.length});return e},g.prototype.removeCollection=function(t){var e,n=this.collections.length;for(e=0;e<n;e+=1)if(this.collections[e].name===t){var i=new k(t,{}),r=this.collections[e];for(var o in r)r.hasOwnProperty(o)&&i.hasOwnProperty(o)&&(r[o]=i[o]);return void this.collections.splice(e,1)}},g.prototype.getName=function(){return this.name},g.prototype.serializeReplacer=function(t,e){switch(t){case"autosaveHandle":case"persistenceAdapter":case"constraints":case"ttl":return null;case"throttledSavePending":case"throttledCallbacks":return;case"lokiConsoleWrapper":return null;default:return e}},g.prototype.serialize=function(t){switch((t=t||{}).hasOwnProperty("serializationMethod")||(t.serializationMethod=this.options.serializationMethod),t.serializationMethod){case"normal":return JSON.stringify(this,this.serializeReplacer);case"pretty":return JSON.stringify(this,this.serializeReplacer,2);case"destructured":return this.serializeDestructured();default:return JSON.stringify(this,this.serializeReplacer)}},g.prototype.toJson=g.prototype.serialize,g.prototype.serializeDestructured=function(t){var e,n,i,r,o,s=[];if((t=t||{}).hasOwnProperty("partitioned")||(t.partitioned=!1),t.hasOwnProperty("delimited")||(t.delimited=!0),t.hasOwnProperty("delimiter")||(t.delimiter=this.options.destructureDelimiter),!0===t.partitioned&&t.hasOwnProperty("partition")&&t.partition>=0)return this.serializeCollection({delimited:t.delimited,delimiter:t.delimiter,collectionIndex:t.partition});for((o=new g(this.filename)).loadJSONObject(this),e=0;e<o.collections.length;e++)o.collections[e].data=[];if(!0===t.partitioned&&-1===t.partition)return o.serialize({serializationMethod:"normal"});for(s.push(o.serialize({serializationMethod:"normal"})),o=null,e=0;e<this.collections.length;e++)if(i=this.serializeCollection({delimited:t.delimited,delimiter:t.delimiter,collectionIndex:e}),!1===t.partitioned&&!1===t.delimited){if(!Array.isArray(i))throw new Error("a nondelimited, non partitioned collection serialization did not return an expected array");for(r=i.length,n=0;n<r;n++)s.push(i[n]),i[n]=null;s.push("")}else s.push(i);return t.partitioned?(t.delimited,s):t.delimited?(s.push(""),s.join(t.delimiter)):(s.push(""),s)},g.prototype.serializeCollection=function(t){var e,n,i=[];if((t=t||{}).hasOwnProperty("delimited")||(t.delimited=!0),!t.hasOwnProperty("collectionIndex"))throw new Error("serializeCollection called without 'collectionIndex' option");for(e=this.collections[t.collectionIndex].data.length,i=[],n=0;n<e;n++)i.push(JSON.stringify(this.collections[t.collectionIndex].data[n]));return t.delimited?(i.push(""),i.join(t.delimiter)):i},g.prototype.deserializeDestructured=function(t,e){var n,i,r,o=[],s=0,a=1,l=!1;if((e=e||{}).hasOwnProperty("partitioned")||(e.partitioned=!1),e.hasOwnProperty("delimited")||(e.delimited=!0),e.hasOwnProperty("delimiter")||(e.delimiter=this.options.destructureDelimiter),e.partitioned){if(e.hasOwnProperty("partition"))return-1===e.partition?n=JSON.parse(t[0]):this.deserializeCollection(t[e.partition+1],e);for(i=(n=JSON.parse(t[0])).collections.length,s=0;s<i;s++)n.collections[s].data=this.deserializeCollection(t[s+1],e);return n}if(e.delimited){if(o=t.split(e.delimiter),t=null,0===o.length)return null}else o=t;for(i=(n=JSON.parse(o[0])).collections.length,o[0]=null;!l;)o[a],""===o[a]?++s>i&&(l=!0):(r=JSON.parse(o[a]),n.collections[s].data.push(r)),o[a++]=null;return n},g.prototype.deserializeCollection=function(t,e){var n,i,r=[];for((e=e||{}).hasOwnProperty("partitioned")||(e.partitioned=!1),e.hasOwnProperty("delimited")||(e.delimited=!0),e.hasOwnProperty("delimiter")||(e.delimiter=this.options.destructureDelimiter),e.delimited?(r=t.split(e.delimiter)).pop():r=t,i=r.length,n=0;n<i;n++)r[n]=JSON.parse(r[n]);return r},g.prototype.loadJSON=function(t,e){var n;if(0===t.length)n={};else switch(this.options.serializationMethod){case"normal":case"pretty":n=JSON.parse(t);break;case"destructured":n=this.deserializeDestructured(t);break;default:n=JSON.parse(t)}this.loadJSONObject(n,e)},g.prototype.loadJSONObject=function(t,e){var i,r,o,s,a,l,c=0,u=t.collections?t.collections.length:0;function h(t){var i,r=e[t.name];return r.proto?(i=r.inflate||n.copyProperties,function(t){var e=new r.proto;return i(t,e),e}):r.inflate}for(this.name=t.name,t.hasOwnProperty("throttledSaves")&&e&&!e.hasOwnProperty("throttledSaves")&&(this.throttledSaves=t.throttledSaves),this.collections=[];c<u;c+=1){if(i=t.collections[c],(r=this.addCollection(i.name,{disableChangesApi:i.disableChangesApi,disableDeltaChangesApi:i.disableDeltaChangesApi,disableMeta:i.disableMeta})).adaptiveBinaryIndices=!!i.hasOwnProperty("adaptiveBinaryIndices")&&!0===i.adaptiveBinaryIndices,r.transactional=i.transactional,r.asyncListeners=i.asyncListeners,r.cloneObjects=i.cloneObjects,r.cloneMethod=i.cloneMethod||"parse-stringify",r.autoupdate=i.autoupdate,r.changes=i.changes,r.dirtyIds=i.dirtyIds||[],e&&!0===e.retainDirtyFlags?r.dirty=i.dirty:r.dirty=!1,o=i.data.length,s=0,e&&e.hasOwnProperty(i.name))for(a=h(i);s<o;s++)l=a(i.data[s]),r.data[s]=l,r.addAutoUpdateObserver(l);else for(;s<o;s++)r.data[s]=i.data[s],r.addAutoUpdateObserver(r.data[s]);if(r.maxId=void 0===i.maxId?0:i.maxId,r.idIndex=i.idIndex,void 0!==i.binaryIndices&&(r.binaryIndices=i.binaryIndices),void 0!==i.transforms&&(r.transforms=i.transforms),r.ensureId(),r.uniqueNames=[],i.hasOwnProperty("uniqueNames"))for(r.uniqueNames=i.uniqueNames,s=0;s<r.uniqueNames.length;s++)r.ensureUniqueIndex(r.uniqueNames[s]);if(void 0!==i.DynamicViews){for(var f=0;f<i.DynamicViews.length;f++){var d=i.DynamicViews[f],p=r.addDynamicView(d.name,d.options);p.resultdata=d.resultdata,p.resultsdirty=d.resultsdirty,p.filterPipeline=d.filterPipeline,p.sortCriteria=d.sortCriteria,p.sortFunction=null,p.sortDirty=d.sortDirty,p.resultset.filteredrows=d.resultset.filteredrows,p.resultset.filterInitialized=d.resultset.filterInitialized,p.rematerialize({removeWhereFilters:!0})}t.databaseVersion<1.5&&(r.ensureAllIndexes(!0),r.dirty=!0)}}},g.prototype.close=function(t){this.autosave&&(this.autosaveDisable(),this.autosaveDirty()&&(this.saveDatabase(t),t=void 0)),t&&this.on("close",t),this.emit("close")},g.prototype.generateChangesNotification=function(t){function e(t){return t.name}var n=[],i=t||this.collections.map(e);return this.collections.forEach((function(t){-1!==i.indexOf(e(t))&&(n=n.concat(t.getChanges()))})),n},g.prototype.serializeChanges=function(t){return JSON.stringify(this.generateChangesNotification(t))},g.prototype.clearChanges=function(){this.collections.forEach((function(t){t.flushChanges&&t.flushChanges()}))},v.prototype.loadDatabase=function(t,e){var n=this;this.options.asyncResponses?setTimeout((function(){n.hashStore.hasOwnProperty(t)?e(n.hashStore[t].value):e(null)}),this.options.asyncTimeout):this.hashStore.hasOwnProperty(t)?e(this.hashStore[t].value):e(null)},v.prototype.saveDatabase=function(t,e,n){var i,r=this;this.options.asyncResponses?setTimeout((function(){i=r.hashStore.hasOwnProperty(t)?r.hashStore[t].savecount:0,r.hashStore[t]={savecount:i+1,lastsave:new Date,value:e},n()}),this.options.asyncTimeout):(i=this.hashStore.hasOwnProperty(t)?this.hashStore[t].savecount:0,this.hashStore[t]={savecount:i+1,lastsave:new Date,value:e},n())},v.prototype.deleteDatabase=function(t,e){this.hashStore.hasOwnProperty(t)&&delete this.hashStore[t],"function"==typeof e&&e()},b.prototype.loadDatabase=function(t,e){var n=this;this.dbname=t,this.dbref=new g(t),this.adapter.loadDatabase(t,(function(t){if(t){"string"!=typeof t&&e(new Error("LokiPartitioningAdapter received an unexpected response from inner adapter loadDatabase()"));var i=JSON.parse(t);n.dbref.loadJSONObject(i),i=null,n.dbref.collections.length,0!==n.dbref.collections.length?(n.pageIterator={collection:0,pageIndex:0},n.loadNextPartition(0,(function(){e(n.dbref)}))):e(n.dbref)}else e(t)}))},b.prototype.loadNextPartition=function(t,e){var n=this.dbname+"."+t,i=this;if(!0===this.options.paging)return this.pageIterator.pageIndex=0,void this.loadNextPage(e);this.adapter.loadDatabase(n,(function(n){var r=i.dbref.deserializeCollection(n,{delimited:!0,collectionIndex:t});i.dbref.collections[t].data=r,++t<i.dbref.collections.length?i.loadNextPartition(t,e):e()}))},b.prototype.loadNextPage=function(t){var e=this.dbname+"."+this.pageIterator.collection+"."+this.pageIterator.pageIndex,n=this;this.adapter.loadDatabase(e,(function(e){var i=e.split(n.options.delimiter);e="";var r,o=i.length,s=""===i[o-1];for(s&&(i.pop(),""===i[(o=i.length)-1]&&1===o&&(i.pop(),o=i.length)),r=0;r<o;r++)n.dbref.collections[n.pageIterator.collection].data.push(JSON.parse(i[r])),i[r]=null;i=[],s?++n.pageIterator.collection<n.dbref.collections.length?n.loadNextPartition(n.pageIterator.collection,t):t():(n.pageIterator.pageIndex++,n.loadNextPage(t))}))},b.prototype.exportDatabase=function(t,e,n){var i,r=e.collections.length;for(this.dbref=e,this.dbname=t,this.dirtyPartitions=[-1],i=0;i<r;i++)e.collections[i].dirty&&this.dirtyPartitions.push(i);this.saveNextPartition((function(t){n(t)}))},b.prototype.saveNextPartition=function(t){var e=this,n=this.dirtyPartitions.shift(),i=this.dbname+(-1===n?"":"."+n);if(this.options.paging&&-1!==n)return this.pageIterator={collection:n,docIndex:0,pageIndex:0},void this.saveNextPage((function(n){0===e.dirtyPartitions.length?t(n):e.saveNextPartition(t)}));var r=this.dbref.serializeDestructured({partitioned:!0,delimited:!0,partition:n});this.adapter.saveDatabase(i,r,(function(n){n?t(n):0===e.dirtyPartitions.length?t(null):e.saveNextPartition(t)}))},b.prototype.saveNextPage=function(t){var e=this,n=this.dbref.collections[this.pageIterator.collection],i=this.dbname+"."+this.pageIterator.collection+"."+this.pageIterator.pageIndex,r=0,o=n.data.length,s=this.options.delimiter.length,a="",l="",c=!1,u=!1,h=function(n){l="",n&&t(n),c?t(null):(e.pageIterator.pageIndex++,e.saveNextPage(t))};for(0===n.data.length&&(c=!0);;)if(c||(a=JSON.stringify(n.data[this.pageIterator.docIndex]),l+=a,r+=a.length,++this.pageIterator.docIndex>=o&&(c=!0)),r>=this.options.pageSize&&(u=!0),u&&!c||(l+=this.options.delimiter,r+=s),c||u)return void this.adapter.saveDatabase(i,l,h)},O.prototype.loadDatabase=function(t,e){var n=this;this.fs.stat(t,(function(i,r){!i&&r.isFile()?n.fs.readFile(t,{encoding:"utf8"},(function(t,n){e(t?new Error(t):n)})):e(null)}))},O.prototype.saveDatabase=function(t,e,n){var i=this,r=t+"~";this.fs.writeFile(r,e,(function(e){e?n(new Error(e)):i.fs.rename(r,t,n)}))},O.prototype.deleteDatabase=function(t,e){this.fs.unlink(t,(function(t){t?e(new Error(t)):e()}))},S.prototype.loadDatabase=function(t,e){y()?e(localStorage.getItem(t)):e(new Error("localStorage is not available"))},S.prototype.saveDatabase=function(t,e,n){y()?(localStorage.setItem(t,e),n(null)):n(new Error("localStorage is not available"))},S.prototype.deleteDatabase=function(t,e){y()?(localStorage.removeItem(t),e(null)):e(new Error("localStorage is not available"))},g.prototype.throttledSaveDrain=function(t,e){var n=this,i=(new Date).getTime();if(this.throttledSaves||t(!0),(e=e||{}).hasOwnProperty("recursiveWait")||(e.recursiveWait=!0),e.hasOwnProperty("recursiveWaitLimit")||(e.recursiveWaitLimit=!1),e.hasOwnProperty("recursiveWaitLimitDuration")||(e.recursiveWaitLimitDuration=2e3),e.hasOwnProperty("started")||(e.started=(new Date).getTime()),this.throttledSaves&&this.throttledSavePending){if(!e.recursiveWait)return void this.throttledCallbacks.push(t);this.throttledCallbacks.push((function(){return n.throttledSavePending?e.recursiveWaitLimit&&i-e.started>e.recursiveWaitLimitDuration?void t(!1):void n.throttledSaveDrain(t,e):void t(!0)}))}else t(!0)},g.prototype.loadDatabaseInternal=function(t,e){var n=e||function(t,e){if(t)throw t},i=this;null!==this.persistenceAdapter?this.persistenceAdapter.loadDatabase(this.filename,(function(e){if("string"==typeof e){var r=!1;try{i.loadJSON(e,t||{}),r=!0}catch(t){n(t)}r&&(n(null),i.emit("loaded","database "+i.filename+" loaded"))}else{if(!e)return n(null),void i.emit("loaded","empty database "+i.filename+" loaded");if(e instanceof Error)return void n(e);if("object"==typeof e)return i.loadJSONObject(e,t||{}),n(null),void i.emit("loaded","database "+i.filename+" loaded");n("unexpected adapter response : "+e)}})):n(new Error("persistenceAdapter not configured"))},g.prototype.loadDatabase=function(t,e){var n=this;this.throttledSaves?this.throttledSaveDrain((function(i){if(i)return n.throttledSavePending=!0,void n.loadDatabaseInternal(t,(function(t){0===n.throttledCallbacks.length?n.throttledSavePending=!1:n.saveDatabase(),"function"==typeof e&&e(t)}));"function"==typeof e&&e(new Error("Unable to pause save throttling long enough to read database"))}),t):this.loadDatabaseInternal(t,e)},g.prototype.saveDatabaseInternal=function(t){var e=t||function(t){if(t)throw t},n=this;if(this.persistenceAdapter)if("reference"!==this.persistenceAdapter.mode&&this.autosaveClearFlags(),"incremental"===this.persistenceAdapter.mode){var i=this.copy({removeNonSerializable:!0}),r=this.collections.map((function(t){return t.dirtyIds}));this.collections.forEach((function(t){t.dirtyIds=[]})),this.persistenceAdapter.saveDatabase(this.filename,i,(function(t){t&&n.collections.forEach((function(t,e){t.dirtyIds=t.dirtyIds.concat(r[e])})),e(t)}))}else"reference"===this.persistenceAdapter.mode&&"function"==typeof this.persistenceAdapter.exportDatabase?this.persistenceAdapter.exportDatabase(this.filename,this.copy({removeNonSerializable:!0}),(function(t){n.autosaveClearFlags(),e(t)})):this.persistenceAdapter.saveDatabase(this.filename,this.serialize(),(function(t){e(t)}));else e(new Error("persistenceAdapter not configured"))},g.prototype.saveDatabase=function(t){if(this.throttledSaves)if(this.throttledSavePending)this.throttledCallbacks.push(t);else{var e=this.throttledCallbacks;this.throttledCallbacks=[],e.unshift(t),this.throttledSavePending=!0;var n=this;this.saveDatabaseInternal((function(t){n.throttledSavePending=!1,e.forEach((function(e){"function"==typeof e&&setTimeout((function(){e(t)}),1)})),n.throttledCallbacks.length>0&&n.saveDatabase()}))}else this.saveDatabaseInternal(t)},g.prototype.save=g.prototype.saveDatabase,g.prototype.deleteDatabase=function(t,e){var n=e||function(t,e){if(t)throw t};"function"!=typeof t||e||(n=t),null!==this.persistenceAdapter?this.persistenceAdapter.deleteDatabase(this.filename,(function(t){n(t)})):n(new Error("persistenceAdapter not configured"))},g.prototype.autosaveDirty=function(){for(var t=0;t<this.collections.length;t++)if(this.collections[t].dirty)return!0;return!1},g.prototype.autosaveClearFlags=function(){for(var t=0;t<this.collections.length;t++)this.collections[t].dirty=!1},g.prototype.autosaveEnable=function(t,e){this.autosave=!0;var n=5e3,i=this;void 0!==this.autosaveInterval&&null!==this.autosaveInterval&&(n=this.autosaveInterval),this.autosaveHandle=setInterval((function(){i.autosaveDirty()&&i.saveDatabase(e)}),n)},g.prototype.autosaveDisable=function(){void 0!==this.autosaveHandle&&null!==this.autosaveHandle&&(clearInterval(this.autosaveHandle),this.autosaveHandle=null)},P.prototype.reset=function(){return this.filteredrows.length>0&&(this.filteredrows=[]),this.filterInitialized=!1,this},P.prototype.toJSON=function(){var t=this.copy();return t.collection=null,t},P.prototype.limit=function(t){this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());var e=new P(this.collection);return e.filteredrows=this.filteredrows.slice(0,t),e.filterInitialized=!0,e},P.prototype.offset=function(t){this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());var e=new P(this.collection);return e.filteredrows=this.filteredrows.slice(t),e.filterInitialized=!0,e},P.prototype.copy=function(){var t=new P(this.collection);return this.filteredrows.length>0&&(t.filteredrows=this.filteredrows.slice()),t.filterInitialized=this.filterInitialized,t},P.prototype.branch=P.prototype.copy,P.prototype.transform=function(t,e){var i,r,o=this;if("string"==typeof t&&this.collection.transforms.hasOwnProperty(t)&&(t=this.collection.transforms[t]),"object"!=typeof t||!Array.isArray(t))throw new Error("Invalid transform");for(void 0!==e&&(t=n.resolveTransformParams(t,e)),i=0;i<t.length;i++)switch((r=t[i]).type){case"find":o.find(r.value);break;case"where":o.where(r.value);break;case"simplesort":o.simplesort(r.property,r.desc||r.options);break;case"compoundsort":o.compoundsort(r.value);break;case"sort":o.sort(r.value);break;case"limit":o=o.limit(r.value);break;case"offset":o=o.offset(r.value);break;case"map":o=o.map(r.value,r.dataOptions);break;case"eqJoin":o=o.eqJoin(r.joinData,r.leftJoinKey,r.rightJoinKey,r.mapFun,r.dataOptions);break;case"mapReduce":o=o.mapReduce(r.mapFunction,r.reduceFunction);break;case"update":o.update(r.value);break;case"remove":o.remove()}return o},P.prototype.sort=function(t){this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());var e,n,i=(e=t,n=this.collection.data,function(t,i){return e(n[t],n[i])});return this.filteredrows.sort(i),this},P.prototype.simplesort=function(t,e){var i,r=10,o=this.collection.data.length,s=this.filteredrows.length,a=this.collection.binaryIndices.hasOwnProperty(t);if(void 0!==e&&!1!==e||(e={desc:!1}),!0===e&&(e={desc:!0}),0===s){if(this.filterInitialized)return this;if(this.collection.binaryIndices.hasOwnProperty(t))return this.collection.ensureIndex(t),this.filteredrows=this.collection.binaryIndices[t].values.slice(0),e.desc&&this.filteredrows.reverse(),this;this.filteredrows=this.collection.prepareFullDocIndex()}else if(!e.disableIndexIntersect&&a&&(i=o/s,e.useJavascriptSorting&&(r=6),i<=r||e.forceIndexIntersect)){var c,u=this.filteredrows,h={};for(c=0;c<s;c++)h[u[c]]=!0;var f=this.collection.binaryIndices[t].values;return this.filteredrows=f.filter((function(t){return h[t]})),e.desc&&this.filteredrows.reverse(),this}if(e.useJavascriptSorting)return this.sort((function(e,n){return e[t]===n[t]?0:e[t]>n[t]?1:e[t]<n[t]?-1:void 0}));var d,p,y,m,g,v,b=(d=t,p=e.desc,y=this.collection.data,function(t,e){return~d.indexOf(".")?(v=d.split("."),m=n.getIn(y[t],v,!0),g=n.getIn(y[e],v,!0)):(m=y[t][d],g=y[e][d]),l(m,g,p)});return this.filteredrows.sort(b),this},P.prototype.compoundsort=function(t){if(0===t.length)throw new Error("Invalid call to compoundsort, need at least one property");var e;if(1===t.length)return e=t[0],Array.isArray(e)?this.simplesort(e[0],e[1]):this.simplesort(e,!1);for(var i=0,r=t.length;i<r;i+=1)e=t[i],Array.isArray(e)||(t[i]=[e,!1]);this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());var o,s,a=(o=t,s=this.collection.data,function(t,e){return function(t,e,i){for(var r,o,s,a,c,u=0,h=0,f=t.length;h<f;h++)if(~(o=(r=t[h])[0]).indexOf(".")?(c=o.split("."),s=n.getIn(e,c,!0),a=n.getIn(i,c,!0)):(s=e[o],a=i[o]),0!==(u=l(s,a,r[1])))return u;return 0}(o,s[t],s[e])});return this.filteredrows.sort(a),this},P.prototype.findOr=function(t){for(var e=null,n=0,i=0,r=[],o=[],s=0,a=(this.count(),0),l=t.length;a<l;a++)for(i=(e=this.branch().find(t[a]).filteredrows).length,n=0;n<i;n++)void 0===o[s=e[n]]&&(o[s]=!0,r.push(s));return this.filteredrows=r,this.filterInitialized=!0,this},P.prototype.$or=P.prototype.findOr,P.prototype.findAnd=function(t){for(var e=0,n=t.length;e<n;e++){if(0===this.count())return this;this.find(t[e])}return this},P.prototype.$and=P.prototype.findAnd,P.prototype.find=function(e,i){if(0===this.collection.data.length)return this.filteredrows=[],this.filterInitialized=!0,this;var r,o,s,a,l,u,h,p=e||"getAll",y=!1,m=[],g=[],v=null;if(i=i||!1,"object"==typeof p){for(r in p)(a={})[r]=p[r],g.push(a),t.call(p,r)&&(o=r,s=p[r]);if(g.length>1)return this.find({$and:g},i)}if(!o||"getAll"===p)return i&&(this.filterInitialized?this.filteredrows=this.filteredrows.slice(0,1):(this.filteredrows=this.collection.data.length>0?[0]:[],this.filterInitialized=!0)),this;if("$and"===o||"$or"===o)return this[o](s),i&&this.filteredrows.length>1&&(this.filteredrows=this.filteredrows.slice(0,1)),this;if(null===s||"object"!=typeof s||s instanceof Date)l="$eq",u=s;else{if("object"!=typeof s)throw new Error("Do not know what you want to do.");for(h in s)if(t.call(s,h)){l=h,u=s[h];break}}"$regex"!==l&&"object"!=typeof u||(u=function t(e,n){if("$regex"===e)Array.isArray(n)?n=new RegExp(n[0],n[1]):n instanceof RegExp||(n=new RegExp(n));else if("object"==typeof n)for(var i in n)"$regex"!==i&&"object"!=typeof n[i]||(n[i]=t(i,n[i]));return n}(l,u));var b=-1!==o.indexOf(".");!this.filterInitialized&&this.collection.binaryIndices[o]&&d[l]&&(!0!==this.collection.adaptiveBinaryIndices&&this.collection.ensureIndex(o),y=!0,v=this.collection.binaryIndices[o]);var w,O=f[l],S=this.collection.data,I=0,P=0,C=0;if(this.filterInitialized){if(P=(w=this.filteredrows).length,b){for(o=o.split("."),I=0;I<P;I++)if(c(S[C=w[I]],o,O,u)&&(m.push(C),i))return this.filteredrows=m,this}else for(I=0;I<P;I++)if(O(S[C=w[I]][o],u)&&(m.push(C),i))return this.filteredrows=m,this}else if(y){var k=this.collection.calculateRange(l,o,u);if("$in"!==l){for(I=k[0];I<=k[1];I++)if(!0!==d[l]){if(d[l](n.getIn(S[v.values[I]],o,b),u)&&(m.push(v.values[I]),i))return this.filteredrows=m,this.filterInitialized=!0,this}else if(m.push(v.values[I]),i)return this.filteredrows=m,this.filterInitialized=!0,this}else for(I=0,P=k.length;I<P;I++)if(m.push(v.values[k[I]]),i)return this.filteredrows=m,this.filterInitialized=!0,this}else if(P=S.length,b){for(o=o.split("."),I=0;I<P;I++)if(c(S[I],o,O,u)&&(m.push(I),i))return this.filteredrows=m,this.filterInitialized=!0,this}else for(I=0;I<P;I++)if(O(S[I][o],u)&&(m.push(I),i))return this.filteredrows=m,this.filterInitialized=!0,this;return this.filteredrows=m,this.filterInitialized=!0,this},P.prototype.where=function(t){var e,n=[];if("function"!=typeof t)throw new TypeError("Argument is not a stored view or a function");e=t;try{if(this.filterInitialized){for(var i=this.filteredrows.length;i--;)!0===e(this.collection.data[this.filteredrows[i]])&&n.push(this.filteredrows[i]);return this.filteredrows=n,this}for(var r=this.collection.data.length;r--;)!0===e(this.collection.data[r])&&n.push(r);return this.filteredrows=n,this.filterInitialized=!0,this}catch(t){throw t}},P.prototype.count=function(){return this.filterInitialized?this.filteredrows.length:this.collection.count()},P.prototype.data=function(t){var e,n,i,r,o=[],s=this.collection.data;if((t=t||{}).removeMeta&&!t.forceClones&&(t.forceClones=!0,t.forceCloneMethod=t.forceCloneMethod||"shallow"),this.collection.disableDeltaChangesApi||(t.forceClones=!0,t.forceCloneMethod="parse-stringify"),!this.filterInitialized){if(0===this.filteredrows.length){if(this.collection.cloneObjects||t.forceClones){for(n=s.length,r=t.forceCloneMethod||this.collection.cloneMethod,i=0;i<n;i++)e=p(s[i],r),t.removeMeta&&(delete e.$loki,delete e.meta),o.push(e);return o}return s.slice()}this.filterInitialized=!0}var a=this.filteredrows;if(n=a.length,this.collection.cloneObjects||t.forceClones)for(r=t.forceCloneMethod||this.collection.cloneMethod,i=0;i<n;i++)e=p(s[a[i]],r),t.removeMeta&&(delete e.$loki,delete e.meta),o.push(e);else for(i=0;i<n;i++)o.push(s[a[i]]);return o},P.prototype.update=function(t){if("function"!=typeof t)throw new TypeError("Argument is not a function");this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());for(var e,n=this.filteredrows.length,i=this.collection.data,r=0;r<n;r++)this.collection.cloneObjects||!this.collection.disableDeltaChangesApi?(t(e=p(i[this.filteredrows[r]],this.collection.cloneMethod)),this.collection.update(e)):(t(i[this.filteredrows[r]]),this.collection.update(i[this.filteredrows[r]]));return this},P.prototype.remove=function(){return this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex()),this.collection.removeBatchByPositions(this.filteredrows),this.filteredrows=[],this},P.prototype.mapReduce=function(t,e){try{return e(this.data().map(t))}catch(t){throw t}},P.prototype.eqJoin=function(t,e,n,i,r){var o,s,a,l,c=[],u=[],h="function"==typeof e,f="function"==typeof n,d={};if(s=(o=this.data(r)).length,t instanceof k)c=t.chain().data(r);else if(t instanceof P)c=t.data(r);else{if(!Array.isArray(t))throw new TypeError("joinData needs to be an array or result set");c=t}a=c.length;for(var p=0;p<a;p++)d[l=f?n(c[p]):c[p][n]]=c[p];i||(i=function(t,e){return{left:t,right:e}});for(var y=0;y<s;y++)l=h?e(o[y]):o[y][e],u.push(i(o[y],d[l]||{}));return this.collection=new k("joinData"),this.collection.insert(u),this.filteredrows=[],this.filterInitialized=!1,this},P.prototype.map=function(t,e){var n=this.data(e).map(t);return this.collection=new k("mappedData"),this.collection.insert(n),this.filteredrows=[],this.filterInitialized=!1,this},C.prototype=new m,C.prototype.rematerialize=function(t){var e,n,i;if(t=t||{},this.resultdata=[],this.resultsdirty=!0,this.resultset=new P(this.collection),(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple)&&(this.sortDirty=!0),t.hasOwnProperty("removeWhereFilters"))for(n=e=this.filterPipeline.length;n--;)"where"===this.filterPipeline[n].type&&(n!==this.filterPipeline.length-1&&(this.filterPipeline[n]=this.filterPipeline[this.filterPipeline.length-1]),this.filterPipeline.length--);var r=this.filterPipeline;for(this.filterPipeline=[],e=r.length,i=0;i<e;i++)this.applyFind(r[i].val);return this.data(),this.emit("rebuild",this),this},C.prototype.branchResultset=function(t,e){var n=this.resultset.branch();return void 0===t?n:n.transform(t,e)},C.prototype.toJSON=function(){var t=new C(this.collection,this.name,this.options);return t.resultset=this.resultset,t.resultdata=[],t.resultsdirty=!0,t.filterPipeline=this.filterPipeline,t.sortFunction=this.sortFunction,t.sortCriteria=this.sortCriteria,t.sortCriteriaSimple=this.sortCriteriaSimple||null,t.sortDirty=this.sortDirty,t.collection=null,t},C.prototype.removeFilters=function(t){t=t||{},this.rebuildPending=!1,this.resultset.reset(),this.resultdata=[],this.resultsdirty=!0,this.cachedresultset=null,this.filterPipeline=[],this.sortFunction=null,this.sortCriteria=null,this.sortCriteriaSimple=null,this.sortDirty=!1,!0===t.queueSortPhase&&this.queueSortPhase()},C.prototype.applySort=function(t){return this.sortFunction=t,this.sortCriteria=null,this.sortCriteriaSimple=null,this.queueSortPhase(),this},C.prototype.applySimpleSort=function(t,e){return this.sortCriteriaSimple={propname:t,options:e||!1},this.sortCriteria=null,this.sortFunction=null,this.queueSortPhase(),this},C.prototype.applySortCriteria=function(t){return this.sortCriteria=t,this.sortCriteriaSimple=null,this.sortFunction=null,this.queueSortPhase(),this},C.prototype.startTransaction=function(){return this.cachedresultset=this.resultset.copy(),this},C.prototype.commit=function(){return this.cachedresultset=null,this},C.prototype.rollback=function(){return this.resultset=this.cachedresultset,this.options.persistent&&(this.resultdata=this.resultset.data(),this.emit("rebuild",this)),this},C.prototype._indexOfFilterWithId=function(t){if("string"==typeof t||"number"==typeof t)for(var e=0,n=this.filterPipeline.length;e<n;e+=1)if(t===this.filterPipeline[e].uid)return e;return-1},C.prototype._addFilter=function(t){this.filterPipeline.push(t),this.resultset[t.type](t.val)},C.prototype.reapplyFilters=function(){this.resultset.reset(),this.cachedresultset=null,this.options.persistent&&(this.resultdata=[],this.resultsdirty=!0);var t=this.filterPipeline;this.filterPipeline=[];for(var e=0,n=t.length;e<n;e+=1)this._addFilter(t[e]);return this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent(),this},C.prototype.applyFilter=function(t){var e=this._indexOfFilterWithId(t.uid);return e>=0?(this.filterPipeline[e]=t,this.reapplyFilters()):(this.cachedresultset=null,this.options.persistent&&(this.resultdata=[],this.resultsdirty=!0),this._addFilter(t),this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent(),this)},C.prototype.applyFind=function(t,e){return this.applyFilter({type:"find",val:t,uid:e}),this},C.prototype.applyWhere=function(t,e){return this.applyFilter({type:"where",val:t,uid:e}),this},C.prototype.removeFilter=function(t){var e=this._indexOfFilterWithId(t);if(e<0)throw new Error("Dynamic view does not contain a filter with ID: "+t);return this.filterPipeline.splice(e,1),this.reapplyFilters(),this},C.prototype.count=function(){return this.resultsdirty&&(this.resultdata=this.resultset.data()),this.resultset.count()},C.prototype.data=function(t){return(this.sortDirty||this.resultsdirty)&&this.performSortPhase({suppressRebuildEvent:!0}),this.options.persistent?this.resultdata:this.resultset.data(t)},C.prototype.queueRebuildEvent=function(){if(!this.rebuildPending){this.rebuildPending=!0;var t=this;setTimeout((function(){t.rebuildPending&&(t.rebuildPending=!1,t.emit("rebuild",t))}),this.options.minRebuildInterval)}},C.prototype.queueSortPhase=function(){if(!this.sortDirty){this.sortDirty=!0;var t=this;"active"===this.options.sortPriority?setTimeout((function(){t.performSortPhase()}),this.options.minRebuildInterval):this.queueRebuildEvent()}},C.prototype.performSortPhase=function(t){(this.sortDirty||this.resultsdirty)&&(t=t||{},this.sortDirty&&(this.sortFunction?this.resultset.sort(this.sortFunction):this.sortCriteria?this.resultset.compoundsort(this.sortCriteria):this.sortCriteriaSimple&&this.resultset.simplesort(this.sortCriteriaSimple.propname,this.sortCriteriaSimple.options),this.sortDirty=!1),this.options.persistent&&(this.resultdata=this.resultset.data(),this.resultsdirty=!1),t.suppressRebuildEvent||this.emit("rebuild",this))},C.prototype.evaluateDocument=function(t,e){if(!this.resultset.filterInitialized)return this.options.persistent&&(this.resultdata=this.resultset.data()),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent());var n,i=this.resultset.filteredrows,r=e?-1:i.indexOf(+t),o=i.length,s=new P(this.collection);s.filteredrows=[t],s.filterInitialized=!0;for(var a=0,l=this.filterPipeline.length;a<l;a++)s[(n=this.filterPipeline[a]).type](n.val);var c=0===s.filteredrows.length?-1:0;return-1!==r||-1!==c?-1===r&&-1!==c?(i.push(t),this.options.persistent&&this.resultdata.push(this.collection.data[t]),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent())):-1!==r&&-1===c?(r<o-1?(i.splice(r,1),this.options.persistent&&this.resultdata.splice(r,1)):(i.length=o-1,this.options.persistent&&(this.resultdata.length=o-1)),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent())):-1!==r&&-1!==c?(this.options.persistent&&(this.resultdata[r]=this.collection.data[t]),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent())):void 0:void 0},C.prototype.removeDocument=function(t){var e,n,i,r={},o={},s=[],a=this.resultset,l=this.resultset.filteredrows,c=l.length;if(!this.resultset.filterInitialized)return this.options.persistent&&(this.resultdata=this.resultset.data()),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent());for(Array.isArray(t)||(t=[t]),i=t.length,n=0;n<i;n++)r[t[n]]=!0;for(e=0;e<c;e++)r[l[e]]&&(o[e]=!0);Object.keys(o).length>0&&(this.resultset.filteredrows=this.resultset.filteredrows.filter((function(t,e){return!o[e]})),this.options.persistent&&(this.resultdata=this.resultdata.filter((function(t,e){return!o[e]}))),this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent());var u=function(t){return function(e){return e<a.filteredrows[t]}};for(c=a.filteredrows.length,e=0;e<c;e++)s=t.filter(u(e)),a.filteredrows[e]-=s.length},C.prototype.mapReduce=function(t,e){try{return e(this.data().map(t))}catch(t){throw t}},k.prototype=new m,k.prototype.createChange=function(t,e,n,i){this.changes.push({name:t,operation:e,obj:"U"!=e||this.disableDeltaChangesApi?JSON.parse(JSON.stringify(n)):this.getChangeDelta(n,i)})},k.prototype.insertMeta=function(t){var e,n;if(!this.disableMeta&&t)if(Array.isArray(t))for(e=t.length,n=0;n<e;n++)t[n].hasOwnProperty("meta")||(t[n].meta={}),t[n].meta.created=(new Date).getTime(),t[n].meta.revision=0;else t.meta||(t.meta={}),t.meta.created=(new Date).getTime(),t.meta.revision=0},k.prototype.updateMeta=function(t){!this.disableMeta&&t&&(t.meta.updated=(new Date).getTime(),t.meta.revision+=1)},k.prototype.createInsertChange=function(t){this.createChange(this.name,"I",t)},k.prototype.createUpdateChange=function(t,e){this.createChange(this.name,"U",t,e)},k.prototype.insertMetaWithChange=function(t){this.insertMeta(t),this.createInsertChange(t)},k.prototype.updateMetaWithChange=function(t,e){this.updateMeta(t),this.createUpdateChange(t,e)},k.prototype.lokiConsoleWrapper={log:function(){},warn:function(){},error:function(){}},k.prototype.addAutoUpdateObserver=function(t){this.autoupdate&&"function"==typeof Object.observe&&Object.observe(t,this.observerCallback,["add","update","delete","reconfigure","setPrototype"])},k.prototype.removeAutoUpdateObserver=function(t){this.autoupdate&&"function"==typeof Object.observe&&Object.unobserve(t,this.observerCallback)},k.prototype.addTransform=function(t,e){if(this.transforms.hasOwnProperty(t))throw new Error("a transform by that name already exists");this.transforms[t]=e},k.prototype.getTransform=function(t){return this.transforms[t]},k.prototype.setTransform=function(t,e){this.transforms[t]=e},k.prototype.removeTransform=function(t){delete this.transforms[t]},k.prototype.byExample=function(t){var e,n,i;for(e in i=[],t)t.hasOwnProperty(e)&&i.push(((n={})[e]=t[e],n));return{$and:i}},k.prototype.findObject=function(t){return this.findOne(this.byExample(t))},k.prototype.findObjects=function(t){return this.find(this.byExample(t))},k.prototype.ttlDaemonFuncGen=function(){var t=this,e=this.ttl.age;return function(){var n=Date.now();t.chain().where((function(t){var i=t.meta.updated||t.meta.created;return e<n-i})).remove()}},k.prototype.setTTL=function(t,e){t<0?clearInterval(this.ttl.daemon):(this.ttl.age=t,this.ttl.ttlInterval=e,this.ttl.daemon=setInterval(this.ttlDaemonFuncGen(),e))},k.prototype.prepareFullDocIndex=function(){for(var t=this.data.length,e=new Array(t),n=0;n<t;n+=1)e[n]=n;return e},k.prototype.configureOptions=function(t){(t=t||{}).hasOwnProperty("adaptiveBinaryIndices")&&(this.adaptiveBinaryIndices=t.adaptiveBinaryIndices,this.adaptiveBinaryIndices&&this.ensureAllIndexes())},k.prototype.ensureIndex=function(t,e){if(void 0===e&&(e=!1),null==t)throw new Error("Attempting to set index without an associated property");if((!this.binaryIndices[t]||e||this.binaryIndices[t].dirty)&&(!0!==this.adaptiveBinaryIndices||!this.binaryIndices.hasOwnProperty(t)||e)){var r={name:t,dirty:!0,values:this.prepareFullDocIndex()};this.binaryIndices[t]=r;var o,s,a,l,c,u=(o=t,s=this.data,function(t,e){if(~o.indexOf(".")?(c=o.split("."),a=n.getIn(s[t],c,!0),l=n.getIn(s[e],c,!0)):(a=s[t][o],l=s[e][o]),a!==l){if(i.lt(a,l,!1))return-1;if(i.gt(a,l,!1))return 1}return 0});r.values.sort(u),r.dirty=!1,this.dirty=!0}},k.prototype.checkAllIndexes=function(e){var n,i=this.binaryIndices,r=[];for(n in i)t.call(i,n)&&(this.checkIndex(n,e)||r.push(n));return r},k.prototype.checkIndex=function(t,e){(e=e||{}).randomSamplingFactor&&!1!==e.randomSampling&&(e.randomSampling=!0),e.randomSamplingFactor=e.randomSamplingFactor||.1,(e.randomSamplingFactor<0||e.randomSamplingFactor>1)&&(e.randomSamplingFactor=.1);var i,r,o,s,a,l=!0;if(!this.binaryIndices.hasOwnProperty(t))throw new Error("called checkIndex on property without an index: "+t);if(this.adaptiveBinaryIndices||this.ensureIndex(t),(s=(a=this.binaryIndices[t].values).length)!==this.data.length)return e.repair&&this.ensureIndex(t,!0),!1;if(0===s)return!0;var c=-1!==t.indexOf(".");if(1===s)l=0===a[0];else if(e.randomSampling){if(f.$lte(n.getIn(this.data[a[0]],t,c),n.getIn(this.data[a[1]],t,c))||(l=!1),f.$lte(n.getIn(this.data[a[s-2]],t,c),n.getIn(this.data[a[s-1]],t,c))||(l=!1),l)for(r=Math.floor((s-1)*e.randomSamplingFactor),i=0;i<r-1;i++)if(o=Math.floor(Math.random()*(s-1)),!f.$lte(n.getIn(this.data[a[o]],t,c),n.getIn(this.data[a[o+1]],t,c))){l=!1;break}}else for(i=0;i<s-1;i++)if(!f.$lte(n.getIn(this.data[a[i]],t,c),n.getIn(this.data[a[i+1]],t,c))){l=!1;break}return!l&&e.repair&&this.ensureIndex(t,!0),l},k.prototype.getBinaryIndexValues=function(t){var e,i=this.binaryIndices[t].values,r=[];for(e=0;e<i.length;e++)r.push(n.getIn(this.data[i[e]],t,!0));return r},k.prototype.ensureUniqueIndex=function(t){var e=this.constraints.unique[t];return e||-1==this.uniqueNames.indexOf(t)&&this.uniqueNames.push(t),this.constraints.unique[t]=e=new N(t),this.data.forEach((function(t){e.set(t)})),e},k.prototype.ensureAllIndexes=function(e){var n,i=this.binaryIndices;for(n in i)t.call(i,n)&&this.ensureIndex(n,e)},k.prototype.flagBinaryIndexesDirty=function(){var e,n=this.binaryIndices;for(e in n)t.call(n,e)&&(n[e].dirty=!0)},k.prototype.flagBinaryIndexDirty=function(t){this.binaryIndices[t]&&(this.binaryIndices[t].dirty=!0)},k.prototype.count=function(t){return t?this.chain().find(t).filteredrows.length:this.data.length},k.prototype.ensureId=function(){var t=this.data.length,e=0;for(this.idIndex=[];e<t;e+=1)this.idIndex.push(this.data[e].$loki)},k.prototype.ensureIdAsync=function(t){this.async((function(){this.ensureId()}),t)},k.prototype.addDynamicView=function(t,e){var n=new C(this,t,e);return this.DynamicViews.push(n),n},k.prototype.removeDynamicView=function(t){this.DynamicViews=this.DynamicViews.filter((function(e){return e.name!==t}))},k.prototype.getDynamicView=function(t){for(var e=0;e<this.DynamicViews.length;e++)if(this.DynamicViews[e].name===t)return this.DynamicViews[e];return null},k.prototype.findAndUpdate=function(t,e){"function"==typeof t?this.updateWhere(t,e):this.chain().find(t).update(e)},k.prototype.findAndRemove=function(t){this.chain().find(t).remove()},k.prototype.insert=function(t){if(!Array.isArray(t))return this.insertOne(t);var e,n=[];this.emit("pre-insert",t);for(var i=0,r=t.length;i<r;i++){if(!(e=this.insertOne(t[i],!0)))return;n.push(e)}return this.emit("insert",n),1===(n=this.cloneObjects?p(n,this.cloneMethod):n).length?n[0]:n},k.prototype.insertOne=function(t,e){var n,i=null;if("object"!=typeof t?i=new TypeError("Document needs to be an object"):null===t&&(i=new TypeError("Object cannot be null")),null!==i)throw this.emit("error",i),i;var r=this.cloneObjects?p(t,this.cloneMethod):t;if(this.disableMeta||void 0!==r.meta||(r.meta={revision:0,created:0}),e||this.emit("pre-insert",r),this.add(r))return this.disableChangesApi?this.insertMeta(r):this.insertMetaWithChange(r),n=this.cloneObjects?p(r,this.cloneMethod):r,e||this.emit("insert",n),this.addAutoUpdateObserver(n),n},k.prototype.clear=function(t){var e=this;t=t||{},this.data=[],this.idIndex=[],this.cachedIndex=null,this.cachedBinaryIndex=null,this.cachedData=null,this.maxId=0,this.DynamicViews=[],this.dirty=!0,!0===t.removeIndices?(this.binaryIndices={},this.constraints={unique:{},exact:{}},this.uniqueNames=[]):(Object.keys(this.binaryIndices).forEach((function(t){e.binaryIndices[t].dirty=!1,e.binaryIndices[t].values=[]})),this.constraints={unique:{},exact:{}},this.uniqueNames.forEach((function(t){e.ensureUniqueIndex(t)})))},k.prototype.update=function(e){var n,i,r;if(Array.isArray(e)){r=e.length,(n=!this.cloneObjects&&this.adaptiveBinaryIndices&&Object.keys(this.binaryIndices).length>0)&&(this.adaptiveBinaryIndices=!1);try{for(i=0;i<r;i+=1)this.update(e[i])}finally{n&&(this.ensureAllIndexes(),this.adaptiveBinaryIndices=!0)}}else{if(!t.call(e,"$loki"))throw new Error("Trying to update unsynced document. Please save the document first by using insert() or addMany()");try{this.startTransaction();var o,s,a,l,c,u=this.get(e.$loki,!0),h=this;if(!u)throw new Error("Trying to update a document not in collection.");o=u[0],a=u[1],s=this.cloneObjects||!this.disableDeltaChangesApi?p(e,this.cloneMethod):e,this.emit("pre-update",e),Object.keys(this.constraints.unique).forEach((function(t){h.constraints.unique[t].update(o,s)})),this.data[a]=s,s!==e&&this.addAutoUpdateObserver(e);for(var f=0;f<this.DynamicViews.length;f++)this.DynamicViews[f].evaluateDocument(a,!1);if(this.adaptiveBinaryIndices){var d=this.binaryIndices;for(l in d)this.adaptiveBinaryIndexUpdate(a,l)}else this.flagBinaryIndexesDirty();return this.idIndex[a]=s.$loki,this.isIncremental&&this.dirtyIds.push(s.$loki),this.commit(),this.dirty=!0,this.disableChangesApi?this.updateMeta(s,null):this.updateMetaWithChange(s,o),c=this.cloneObjects?p(s,this.cloneMethod):s,this.emit("update",c,o),c}catch(t){throw this.rollback(),this.lokiConsoleWrapper.error(t.message),this.emit("error",t),t}}},k.prototype.add=function(e){if("object"!=typeof e)throw new TypeError("Object being added needs to be an object");if(void 0!==e.$loki)throw new Error("Document is already in collection, please use update()");try{this.startTransaction(),this.maxId++,isNaN(this.maxId)&&(this.maxId=this.data[this.data.length-1].$loki+1),e.$loki=this.maxId,this.disableMeta||(e.meta.version=0);var n,i=this.constraints.unique;for(n in i)t.call(i,n)&&i[n].set(e);this.idIndex.push(e.$loki),this.isIncremental&&this.dirtyIds.push(e.$loki),this.data.push(e);for(var r=this.data.length-1,o=this.DynamicViews.length,s=0;s<o;s++)this.DynamicViews[s].evaluateDocument(r,!0);if(this.adaptiveBinaryIndices){var a=this.binaryIndices;for(n in a)this.adaptiveBinaryIndexInsert(r,n)}else this.flagBinaryIndexesDirty();return this.commit(),this.dirty=!0,this.cloneObjects?p(e,this.cloneMethod):e}catch(t){throw this.rollback(),this.lokiConsoleWrapper.error(t.message),this.emit("error",t),t}},k.prototype.updateWhere=function(t,e){var n,i=this.where(t),r=0;try{for(;r<i.length;r++)n=e(i[r]),this.update(n)}catch(t){this.rollback(),this.lokiConsoleWrapper.error(t.message)}},k.prototype.removeWhere=function(t){var e;"function"==typeof t?(e=this.data.filter(t),this.remove(e)):this.chain().find(t).remove()},k.prototype.removeDataOnly=function(){this.remove(this.data.slice())},k.prototype.removeBatchByPositions=function(t){var e,n,i,r,o=t.length,s={},a=Object.keys(this.binaryIndices).length,l=Object.keys(this.constraints.unique).length,c=this.adaptiveBinaryIndices&&Object.keys(this.binaryIndices).length>0,u=this;try{for(this.startTransaction(),i=0;i<o;i++)s[this.idIndex[t[i]]]=!0;if((e=this.DynamicViews.length)>0||a>0||l>0){if(e>0)for(n=0;n<e;n++)this.DynamicViews[n].removeDocument(t);if(this.adaptiveBinaryIndices&&!c){var h,f=this.binaryIndices;for(h in f)this.adaptiveBinaryIndexRemove(t,h)}else this.flagBinaryIndexesDirty();l&&Object.keys(this.constraints.unique).forEach((function(e){for(i=0;i<o;i++)null!==(r=u.data[t[i]])[e]&&void 0!==r[e]&&u.constraints.unique[e].remove(r[e])}))}if(!this.disableChangesApi||this.events.delete.length>1)for(i=0;i<o;i++)this.emit("delete",this.data[t[i]]);this.data=this.data.filter((function(t){return!s[t.$loki]})),this.idIndex=this.idIndex.filter((function(t){return!s[t]})),this.adaptiveBinaryIndices&&c&&(this.adaptiveBinaryIndices=!1,this.ensureAllIndexes(!0),this.adaptiveBinaryIndices=!0),this.commit(),this.dirty=!0}catch(t){return this.rollback(),c&&(this.adaptiveBinaryIndices=!0),this.lokiConsoleWrapper.error(t.message),this.emit("error",t),null}},k.prototype.removeBatch=function(t){var e,n=t.length,i=this.data.length,r={},o=[];for(e=0;e<i;e++)r[this.data[e].$loki]=e;for(e=0;e<n;e++)"object"==typeof t[e]?o.push(r[t[e].$loki]):o.push(r[t[e]]);this.removeBatchByPositions(o)},k.prototype.remove=function(e){if("number"==typeof e&&(e=this.get(e)),"object"!=typeof e)throw new Error("Parameter is not an object");if(Array.isArray(e))this.removeBatch(e);else{if(!t.call(e,"$loki"))throw new Error("Object is not a document stored in the collection");try{this.startTransaction();var n=this.get(e.$loki,!0),i=n[1],r=this;Object.keys(this.constraints.unique).forEach((function(t){null!==e[t]&&void 0!==e[t]&&r.constraints.unique[t].remove(e[t])}));for(var o=0;o<this.DynamicViews.length;o++)this.DynamicViews[o].removeDocument(i);if(this.adaptiveBinaryIndices){var s,a=this.binaryIndices;for(s in a)this.adaptiveBinaryIndexRemove(i,s)}else this.flagBinaryIndexesDirty();return this.data.splice(i,1),this.removeAutoUpdateObserver(e),this.idIndex.splice(i,1),this.isIncremental&&this.dirtyIds.push(e.$loki),this.commit(),this.dirty=!0,this.emit("delete",n[0]),delete e.$loki,delete e.meta,e}catch(t){return this.rollback(),this.lokiConsoleWrapper.error(t.message),this.emit("error",t),null}}},k.prototype.get=function(t,e){var n=e||!1,i=this.idIndex,r=i.length-1,o=0,s=o+r>>1;if(t="number"==typeof t?t:parseInt(t,10),isNaN(t))throw new TypeError("Passed id is not an integer");for(;i[o]<i[r];)i[s=o+r>>1]<t?o=s+1:r=s;return r===o&&i[o]===t?n?[this.data[o],o]:this.data[o]:null},k.prototype.getBinaryIndexPosition=function(t,e){var i=n.getIn(this.data[t],e,!0),r=this.binaryIndices[e].values,o=this.calculateRange("$eq",e,i);if(0===o[0]&&-1===o[1])return null;for(var s=o[0],a=o[1],l=s;l<=a;l++)if(r[l]===t)return l;return null},k.prototype.adaptiveBinaryIndexInsert=function(t,e){var i=-1!==e.indexOf("."),r=this.binaryIndices[e].values,o=n.getIn(this.data[t],e,i);!0===this.serializableIndices&&o instanceof Date&&(this.data[t][e]=o.getTime(),o=n.getIn(this.data[t],e));var s=0===r.length?0:this.calculateRangeStart(e,o,!0,i);this.binaryIndices[e].values.splice(s,0,t)},k.prototype.adaptiveBinaryIndexUpdate=function(t,e){var n,i=this.binaryIndices[e].values,r=i.length;for(n=0;n<r&&i[n]!==t;n++);this.binaryIndices[e].values.splice(n,1),this.adaptiveBinaryIndexInsert(t,e)},k.prototype.adaptiveBinaryIndexRemove=function(t,e,n){var i,r,o,s,a,l,c,u=this.binaryIndices[e],h={};if(Array.isArray(t)){if(1!==(s=t.length)){for(o=0;o<s;o++)h[t[o]]=!0;if(u.values=u.values.filter((function(t){return!h[t]})),!0===n)return;var f=t.slice();for(f.sort((function(t,e){return t-e})),i=u.values.length,r=0;r<i;r++){for(a=u.values[r],l=0,o=0;o<s&&a>f[o];o++)l++;u.values[r]-=l}return}t=t[0]}if(null===(c=this.getBinaryIndexPosition(t,e)))return null;if(u.values.splice(c,1),!0!==n)for(i=u.values.length,r=0;r<i;r++)u.values[r]>t&&u.values[r]--},k.prototype.calculateRangeStart=function(t,e,r,o){var s=this.data,a=this.binaryIndices[t].values,l=0,c=a.length-1,u=0;if(0===a.length)return-1;for(n.getIn(s[a[l]],t,o),n.getIn(s[a[c]],t,o);l<c;)u=l+c>>1,i.lt(n.getIn(s[a[u]],t,o),e,!1)?l=u+1:c=u;var h=l;return i.aeq(e,n.getIn(s[a[h]],t,o))?h:i.lt(e,n.getIn(s[a[h]],t,o),!1)?r?h:h-1:r?h+1:h},k.prototype.calculateRangeEnd=function(t,e,r){var o=this.data,s=this.binaryIndices[t].values,a=0,l=s.length-1,c=0;if(0===s.length)return-1;for(n.getIn(o[s[a]],t,r),n.getIn(o[s[l]],t,r);a<l;)c=a+l>>1,i.lt(e,n.getIn(o[s[c]],t,r),!1)?l=c:a=c+1;var u=l;return i.aeq(e,n.getIn(o[s[u]],t,r))?u:i.gt(e,n.getIn(o[s[u]],t,r),!1)?u+1:i.aeq(e,n.getIn(o[s[u-1]],t,r))?u-1:u},k.prototype.calculateRange=function(t,e,r){var o,s,a,l=this.data,c=this.binaryIndices[e].values,u=c.length-1;if(0===l.length)return[0,-1];var h=-1!==e.indexOf("."),f=n.getIn(l[c[0]],e,h),d=n.getIn(l[c[u]],e,h);switch(t){case"$eq":case"$aeq":case"$dteq":if(i.lt(r,f,!1)||i.gt(r,d,!1))return[0,-1];break;case"$gt":if(i.gt(r,d,!0))return[0,-1];if(i.gt(f,r,!1))return[0,u];break;case"$gte":if(i.gt(r,d,!1))return[0,-1];if(i.gt(f,r,!0))return[0,u];break;case"$lt":if(i.lt(r,f,!0))return[0,-1];if(i.lt(d,r,!1))return[0,u];break;case"$lte":if(i.lt(r,f,!1))return[0,-1];if(i.lt(d,r,!0))return[0,u];break;case"$between":return i.gt(r[0],d,!1)||i.lt(r[1],f,!1)?[0,-1]:((o=this.calculateRangeStart(e,r[0],!1,h))<0&&o++,(a=this.calculateRangeEnd(e,r[1],h))>u&&a--,i.gt(n.getIn(l[c[o]],e,h),r[0],!0)||o++,i.lt(n.getIn(l[c[a]],e,h),r[1],!0)||a--,a<o?[0,-1]:[o,a]);case"$in":for(var p=[],y=[],m=0,g=r.length;m<g;m++)for(var v=this.calculateRange("$eq",e,r[m]),b=v[0];b<=v[1];b++)void 0===p[b]&&(p[b]=!0,y.push(b));return y}switch(t){case"$eq":case"$aeq":case"$dteq":case"$gte":case"$lt":o=this.calculateRangeStart(e,r,!1,h),s=n.getIn(l[c[o]],e,h)}switch(t){case"$eq":case"$aeq":case"$dteq":case"$lte":case"$gt":a=this.calculateRangeEnd(e,r,h),n.getIn(l[c[a]],e,h)}switch(t){case"$eq":case"$aeq":case"$dteq":return i.aeq(s,r)?[o,a]:[0,-1];case"$gt":return i.aeq(n.getIn(l[c[a]],e,h),r)?[a+1,u]:[a,u];case"$gte":return i.aeq(n.getIn(l[c[o]],e,h),r)?[o,u]:[o+1,u];case"$lt":return i.aeq(n.getIn(l[c[o]],e,h),r)?[0,o-1]:[0,o];case"$lte":return i.aeq(n.getIn(l[c[a]],e,h),r)?[0,a]:[0,a-1];default:return[0,l.length-1]}},k.prototype.by=function(t,e){var n;if(void 0===e)return n=this,function(e){return n.by(t,e)};var i=this.constraints.unique[t].get(e);return this.cloneObjects?p(i,this.cloneMethod):i},k.prototype.findOne=function(t){t=t||{};var e=this.chain().find(t,!0).data();return Array.isArray(e)&&0===e.length?null:this.cloneObjects?p(e[0],this.cloneMethod):e[0]},k.prototype.chain=function(t,e){var n=new P(this);return void 0===t?n:n.transform(t,e)},k.prototype.find=function(t){return this.chain().find(t).data()},k.prototype.findOneUnindexed=function(t,e){for(var i=this.data.length;i--;)if(n.getIn(this.data[i],t,!0)===e)return this.data[i];return null},k.prototype.startTransaction=function(){if(this.transactional){this.cachedData=p(this.data,this.cloneMethod),this.cachedIndex=this.idIndex,this.cachedBinaryIndex=this.binaryIndices,this.cachedDirtyIds=this.dirtyIds;for(var t=0;t<this.DynamicViews.length;t++)this.DynamicViews[t].startTransaction()}},k.prototype.commit=function(){if(this.transactional){this.cachedData=null,this.cachedIndex=null,this.cachedBinaryIndex=null,this.cachedDirtyIds=null;for(var t=0;t<this.DynamicViews.length;t++)this.DynamicViews[t].commit()}},k.prototype.rollback=function(){if(this.transactional){null!==this.cachedData&&null!==this.cachedIndex&&(this.data=this.cachedData,this.idIndex=this.cachedIndex,this.binaryIndices=this.cachedBinaryIndex,this.dirtyIds=this.cachedDirtyIds);for(var t=0;t<this.DynamicViews.length;t++)this.DynamicViews[t].rollback()}},k.prototype.async=function(t,e){setTimeout((function(){if("function"!=typeof t)throw new TypeError("Argument passed for async execution is not a function");t(),e()}),0)},k.prototype.where=function(t){return this.chain().where(t).data()},k.prototype.mapReduce=function(t,e){try{return e(this.data.map(t))}catch(t){throw t}},k.prototype.eqJoin=function(t,e,n,i,r){return new P(this).eqJoin(t,e,n,i,r)},k.prototype.stages={},k.prototype.getStage=function(t){return this.stages[t]||(this.stages[t]={}),this.stages[t]},k.prototype.commitLog=[],k.prototype.stage=function(t,e){var n=JSON.parse(JSON.stringify(e));return this.getStage(t)[e.$loki]=n,n},k.prototype.commitStage=function(t,e){var n,i=this.getStage(t),r=(new Date).getTime();for(n in i)this.update(i[n]),this.commitLog.push({timestamp:r,message:e,data:JSON.parse(JSON.stringify(i[n]))});this.stages[t]={}},k.prototype.no_op=function(){},k.prototype.extract=function(t){for(var e=0,n=this.data.length,i=x(t),r=[];e<n;e+=1)r.push(M(this.data[e],t,i));return r},k.prototype.max=function(t){return Math.max.apply(null,this.extract(t))},k.prototype.min=function(t){return Math.min.apply(null,this.extract(t))},k.prototype.maxRecord=function(t){for(var e,n=0,i=this.data.length,r=x(t),o={index:0,value:void 0};n<i;n+=1)void 0!==e?e<M(this.data[n],t,r)&&(e=M(this.data[n],t,r),o.index=this.data[n].$loki):(e=M(this.data[n],t,r),o.index=this.data[n].$loki);return o.value=e,o},k.prototype.minRecord=function(t){for(var e,n=0,i=this.data.length,r=x(t),o={index:0,value:void 0};n<i;n+=1)void 0!==e?e>M(this.data[n],t,r)&&(e=M(this.data[n],t,r),o.index=this.data[n].$loki):(e=M(this.data[n],t,r),o.index=this.data[n].$loki);return o.value=e,o},k.prototype.extractNumerical=function(t){return this.extract(t).map(A).filter(Number).filter((function(t){return!isNaN(t)}))},k.prototype.avg=function(t){return j(this.extractNumerical(t))},k.prototype.stdDev=function(t){return e=this.extractNumerical(t),n=j(e),i=j(e.map((function(t){var e=t-n;return e*e}))),Math.sqrt(i);var e,n,i},k.prototype.mode=function(t){var e,n,i,r={},o=this.extract(t);for(n in o.forEach((function(t){r[t]?r[t]+=1:r[t]=1})),r)e?e<r[n]&&(i=n):(i=n,e=r[n]);return i},k.prototype.median=function(t){var e=this.extractNumerical(t);e.sort(T);var n=Math.floor(e.length/2);return e.length%2?e[n]:(e[n-1]+e[n])/2},R.prototype={keys:[],values:[],sort:function(t,e){return t<e?-1:t>e?1:0},setSort:function(t){this.bs=new q(t)},bs:function(){return new q(this.sort)},set:function(t,e){var n=this.bs(this.keys,t);n.found?this.values[n.index]=e:(this.keys.splice(n.index,0,t),this.values.splice(n.index,0,e))},get:function(t){return this.values[E(this.keys,t,this.sort).index]}},N.prototype.keyMap={},N.prototype.lokiMap={},N.prototype.set=function(t){var e=t[this.field];if(null!=e){if(this.keyMap[e])throw new Error("Duplicate key for property "+this.field+": "+e);this.keyMap[e]=t,this.lokiMap[t.$loki]=e}},N.prototype.get=function(t){return this.keyMap[t]},N.prototype.byId=function(t){return this.keyMap[this.lokiMap[t]]},N.prototype.update=function(t,e){if(this.lokiMap[t.$loki]!==e[this.field]){var n=this.lokiMap[t.$loki];this.set(e),this.keyMap[n]=void 0}else this.keyMap[t[this.field]]=e},N.prototype.remove=function(t){var e=this.keyMap[t];if(null==e)throw new Error("Key is not in unique index: "+this.field);this.keyMap[t]=void 0,this.lokiMap[e.$loki]=void 0},N.prototype.clear=function(){this.keyMap={},this.lokiMap={}},_.prototype={set:function(t,e){this.index[t]?this.index[t].push(e):this.index[t]=[e]},remove:function(t,e){var n=this.index[t];for(var i in n)n[i]==e&&n.splice(i,1);n.length<1&&(this.index[t]=void 0)},get:function(t){return this.index[t]},clear:function(t){this.index={}}},g.LokiOps=f,g.Collection=k,g.KeyValueStore=R,g.LokiMemoryAdapter=v,g.LokiPartitioningAdapter=b,g.LokiLocalStorageAdapter=S,g.LokiFsAdapter=O,g.persistenceAdapters={fs:O,localStorage:S},g.aeq=o,g.lt=s,g.gt=a,g.Comparators=i,g}()},"object"==typeof o?o=S():O.loki=S();var P;P=JSON.parse('[{"unit":"Introduction to Javascript","slides":[{"title":"Introduction to Javascript","url":"/slides/01-Introduction to Javascript.pdf"}],"recordings":[{"title":"Intro to Javascript Part 1 (Fall 2019)","url":"https://mediaspace.carleton.ca/media/2406b-sept6/1_tdi9wkpi"},{"title":"Intro to Javascript Part 2 (Winter 2020)","url":"https://mediaspace.carleton.ca/media/2406-jan14/1_ic9zk1je"}],"code":[{"title":"Intro to Javascript Code","url":"/code/Intro to Javascript Code.zip"}]},{"unit":"Javascript and the Document Object Model","slides":[{"title":"Javascript and the Document Object Model","url":"/slides/02-Javascript and the Document Object Model.pdf"}],"recordings":[{"title":"Javascript and the DOM Part 1 (starts around 36:30) (Winter 2020)","url":"https://mediaspace.carleton.ca/media/2406-jan14/1_ic9zk1je"},{"title":"Javascript and the DOM Part 2 + tutorial #2 discussion (Winter 2020)","url":"https://mediaspace.carleton.ca/media/2406-jan16/1_kndl42yy"}],"code":[{"title":"Javascript and the DOM Code","url":"/code/Javascript and the DOM Code.zip"}]},{"unit":"Intro to Web Apps and HTTP","slides":[{"title":"Intro to Web Apps and HTTP","url":"/slides/03-Intro to Web Apps and HTTP.pdf"}],"recordings":[{"title":"Intro to Web Apps and HTTP Part 1 (and Assignment #1 demo) (Winter 2020)","url":"https://mediaspace.carleton.ca/media/1_58d67hpu"},{"title":"Intro to Web Apps and HTTP Part 2 (Winter 2020)","url":"https://mediaspace.carleton.ca/media/t/1_9jzumk00"}]},{"unit":"AJAX","slides":[{"title":"AJAX","url":"/slides/04-AJAX.pdf"}],"recordings":[{"title":"AJAX (starts around 19:30) (Winter 2020)","url":"https://mediaspace.carleton.ca/media/t/1_9jzumk00"}]},{"unit":"Client-Server Achitecture","slides":[{"title":"Client-Server Achitecture","url":"/slides/05-Client-Server Architecture.pdf"}],"recordings":[{"title":"Client-Server Architecture Part 1 (starts at 1:06:00) (Winter 2020)","url":"https://mediaspace.carleton.ca/media/t/1_9jzumk00"},{"title":"Client Server Architecture Part 2 (Winter 2020)","url":"https://mediaspace.carleton.ca/media/1_ogn5rof5"}]},{"unit":"Intro to Node.js","slides":[{"title":"Intro to Node.js","url":"/slides/06-Intro to Node.pdf"}],"recordings":[{"title":"Intro to Node Part 1 (starts at 43:50) (Winter 2020)","url":"https://mediaspace.carleton.ca/media/1_ogn5rof5"},{"title":"Intro to Node Part 2 (Winter 2020)","url":"https://mediaspace.carleton.ca/media/2406-jan30/1_1amuu28j"},{"title":"Intro to Node Part 3 (Winter 2020)","url":"https://mediaspace.carleton.ca/media/2406-feb4/1_in4w4w16"}],"code":[{"title":"Intro to Node Code","url":"/code/Intro to Node Code.zip"},{"title":"Iterating Object Keys and Retrieving Event Sources Code","url":"/code/Iterating Object Keys and Retrieving Event Sources Code-20200512.zip"}]},{"unit":"Node Package Manager (NPM)","slides":[{"title":"07-Intro to NPM","url":"/slides/07-Intro to NPM.pdf"}],"recordings":[{"title":"Intro to NPM (starts at 16:40) (Winter 2020)","url":"https://mediaspace.carleton.ca/media/2406-feb4/1_in4w4w16"}]},{"unit":"Template Engines","slides":[{"title":"Template Engines","url":"/slides/08-Template Engines.pdf"}],"recordings":[{"title":"Template Engines Part 1 (starts at 40:00) (Winter 2020)","url":"https://mediaspace.carleton.ca/media/2406-feb4/1_in4w4w16"},{"title":"Template Engines Part 2 (Winter 2020)","url":"https://mediaspace.carleton.ca/media/1_w2sshyc6"},{"title":"Template Engines Part 3 (Winter 2020)","url":"https://mediaspace.carleton.ca/media/1_85to4kgx"}],"code":[{"title":"Template Engine Code","url":"/code/Template-Engine-Code.zip"}]},{"unit":"RESTful Web Design","slides":[{"title":"RESTful Web Design","url":"/slides/09-RESTful Web Design.pdf"}],"recordings":[{"title":"RESTful Web Design Part 1 (starts at 54:00) (Winter 2020)","url":"https://mediaspace.carleton.ca/media/1_85to4kgx"},{"title":"RESTful Web Design Part 2 (Winter 2020)","url":"https://mediaspace.carleton.ca/media/2406-feb13/1_gckubhrr"}]},{"unit":"Middleware and Connect","slides":[{"title":"Middleware and Connect","url":"/slides/10-Middleware and Connect.pdf"}],"recordings":[{"title":"Middleware and Connect Part 1 (starts at 47:00) (Winter 2020)","url":"https://mediaspace.carleton.ca/media/2406-feb13/1_gckubhrr"},{"title":"Middleware and Connect Part 2 (Winter 2020)","url":"https://mediaspace.carleton.ca/media/2406-feb25/1_r4pin9f2"}],"code":[{"title":"Middleware and Connect Code","url":"/code/Middleware-and-Connect-Code.zip"}]},{"unit":"Express","slides":[{"title":"Intro to Express","url":"/slides/11-Express.pdf"},{"title":"More Express","url":"/slides/12-More Express.pdf"}],"recordings":[{"title":"Express Part 1 (starts at 35:15) (Winter 2020)","url":"https://mediaspace.carleton.ca/media/2406-feb25/1_r4pin9f2"},{"title":"Express Part 2 (and A3 demonstration) (Winter 2020)","url":"https://mediaspace.carleton.ca/media/1_egqto831"},{"title":"Express Part 3 (Winter 2020)","url":"https://mediaspace.carleton.ca/media/2406-mar5/1_v2zwb13t"},{"title":"Express Part 4 (Winter 2020)","url":"https://mediaspace.carleton.ca/media/2406-mar10/1_enbl9gs4"}],"code":[{"title":"Intro to Express Code","url":"/code/Express-Code.zip"},{"title":"More Express Base Code","url":"/code/More-Express-Base-Code.zip"},{"title":"More Express Completed Code","url":"/code/More-Express-Completed-Code.zip"}]},{"unit":"MongoDB","slides":[{"title":"Intro to MongoDB","url":"/slides/13-Intro to MongoDB.pdf"},{"title":"MongoDB and Node.js","url":"/slides/14-MongoDB and Node.pdf"},{"title":"MongoDB and Node.js (Fall 2019)","url":"/slides/Mongo and Node-Fall2019.pdf"}],"recordings":[{"title":"MongoDB Part 1 (starts at 29:00) (Winter 2020)","url":"https://mediaspace.carleton.ca/media/2406-mar10/1_enbl9gs4"},{"title":"MongoDB Part 2 (Winter 2020)","url":"https://mediaspace.carleton.ca/media/1_yuqceu1t"},{"title":"MongoDB (Fall 2019)","url":"https://mediaspace.carleton.ca/media/1_wlnax17h"}],"code":[{"title":"MongoDB Code (Winter 2020)","url":"/code/MongoDB-Code.zip"},{"title":"MongoDB Code (Fall 2019)","url":"/code/Mongo and Node Code.zip"}]},{"unit":"Mongoose","slides":[{"title":"Introduction to Mongoose","url":"/slides/Introduction to Mongoose.pdf"},{"title":"More Mongoose","url":"/slides/More Mongoose.pdf"}],"recordings":[{"title":"Intro to Mongoose (Fall 2019)","url":"https://mediaspace.carleton.ca/media/2406-nov13/1_228yxe1o"},{"title":"More Mongoose (Fall 2019)","url":"https://mediaspace.carleton.ca/media/1_uoqvgdh4"},{"title":"Mongoose Wrap-up (Fall 2019)","url":"https://mediaspace.carleton.ca/media/2406-nov20/1_a6stgob0"}],"code":[{"title":"Intro to Mongoose Code","url":"/code/Intro-to-Mongoose-Code.zip"},{"title":"More Mongoose Code","url":"/code/More-Mongoose-Code.zip"}]},{"unit":"Authentication, Authorization, and Sessions","slides":[{"title":"Authentication Authorization and Sessions","url":"/slides/Authentication Authorization and Sessions.pdf"},{"title":"HTTPS","url":"/slides/HTTPS.pdf"}],"recordings":[{"title":"Authentication, Authorization, Sessions Part 1 (starts at 8:00) (Fall 2019)","url":"https://mediaspace.carleton.ca/media/2406-nov20/1_a6stgob0"},{"title":"Authentication, Authorization, Sessions Part 2 (Fall 2019)","url":"https://mediaspace.carleton.ca/media/2406-nov22/1_4c8rnv58"}],"code":[{"title":"Authentication, Authorization, and Sessions Code","url":"/code/Authentication Authorization Sessions Code.zip"},{"title":"HTTPS Server","url":"/code/HTTPS-Server.zip"}]},{"unit":"Web Sockets and Socket.io","slides":[{"title":"Web Sockets and Socket.io","url":"/slides/07-Socket IO.pdf"}],"recordings":[{"title":"Socket.io (Fall 2019)","url":"https://mediaspace.carleton.ca/media/2406-SEPT27/1_5jwqqfio"}],"code":[{"title":"Socket.io Chat Code","url":"/code/SocketIO-ChatServerCode.zip"}]},{"unit":"Git and Heroku","slides":[{"title":"Git and Heroku","url":"/slides/Heroku and Git.pdf"}],"recordings":[{"title":"Git and Heroku (Fall 2019)","url":"https://mediaspace.carleton.ca/media/1_u3xnndw1"}]}]');var C;C=JSON.parse('[{"name":"Assignment #1 - Client-side programming with Javascript","term":"Winter 2020","specfile":{"title":"COMP2406-F20-A1 Specification","url":"/assignments/winter2020/a1/COMP2406-F20-A1 Specification.pdf"},"resources":[{"title":"client.js","url":"/assignments/winter2020/a1/client.js"},{"title":"add.jpg","url":"/assignments/winter2020/a1/add.jpg"},{"title":"remove.jpg","url":"/assignments/winter2020/a1/remove.jpg"},{"title":"example-menu-data.txt","url":"/assignments/winter2020/a1/example-menu-data.txt"},{"title":"COMP2406-W20-A1 Marking Scheme","url":"/assignments/winter2020/a1/COMP2406-W20-A1 Marking Scheme.txt"}]},{"name":"Assignment #2 - Server-side programming and AJAX","term":"Winter 2020","specfile":{"title":"COMP2406-W20-A2 Specification","url":"/assignments/winter2020/a2/COMP2406-W20-A2 Specification.pdf"},"resources":[{"title":"assignment2-basecode.zip","url":"/assignments/winter2020/a2/assignment2-basecode.zip"},{"title":"COMP2406-W20-A2 Marking Scheme.txt","url":"/assignments/winter2020/a2/COMP2406-W20-A2 Marking Scheme.txt"}]},{"name":"Assignment #3 - Express Restaurant Manager","term":"Winter 2020","specfile":{"title":"COMP2406-W20-A3 Specification","url":"/assignments/winter2020/a3/COMP2406-W20-A3 Specification.pdf"},"resources":[{"title":"A3-Data.zip","url":"/assignments/winter2020/a3/A3-Data.zip"},{"title":"COMP2406-W20-A3 Marking Scheme.txt","url":"/assignments/winter2020/a3/COMP2406-W20-A3 Marking Scheme.txt"}]},{"name":"Assignment #4 - MongoDB and Sessions","term":"Winter 2020","specfile":{"title":"COMP2406-W20-A4 Specification","url":"/assignments/winter2020/a4/COMP2406-W20-A4 Specification.pdf"},"resources":[{"title":"A4-Data.zip","url":"/assignments/winter2020/a4/A4-Data.zip"},{"title":"A4 Demo Video","url":"https://mediaspace.carleton.ca/media/1_ym36jqpv"},{"title":"COMP2406-W20-A4 Marking Scheme.txt","url":"/assignments/winter2020/a4/COMP2406-W20-A4 Marking Scheme.txt"}]},{"name":"Final Assessment - Card Game Trading","term":"Winter 2020","specfile":{"title":"COMP2406-W20-A5 Specification","url":"/assignments/winter2020/a5/COMP2406-W20-A5 Specification.pdf"},"resources":[{"title":"database-initializer.js","url":"/assignments/winter2020/a5/database-initializer.js"},{"title":"A5 Demo Video","url":"https://mediaspace.carleton.ca/media/1_a68wh0k1"},{"title":"COMP2406-W20-A5 Marking Scheme.txt","url":"/assignments/winter2020/a5/COMP2406-W20-A5 Marking Scheme.txt"}]},{"name":"Assignment #1 - Client-side programming with Javascript","term":"Fall 2019","specfile":{"title":"COMP2406-F19-A1 Specification","url":"/assignments/fall2019/a1/COMP2406-F19-A1 Specification.pdf"},"resources":[{"title":"trivia.js","url":"/assignments/fall2019/a1/trivia.js"},{"title":"check.png","url":"/assignments/fall2019/a1/check.png"},{"title":"x.png","url":"/assignments/fall2019/a1/x.png"},{"title":"COMP2406-F19-A1 Marking Scheme.txt","url":"/assignments/fall2019/a1/COMP2406-F19-A1 Marking Scheme.txt"}]},{"name":"Assignment #2 - Real-time communication using Socket.io","term":"Fall 2019","specfile":{"title":"COMP2406-F19-A2 Specification.pdf","url":"/assignments/fall2019/a2/COMP2406-F19-A2 Specification.pdf"},"resources":[{"title":"COMP2406-F19-A2 Marking Scheme.pdf","url":"/assignments/fall2019/a2/COMP2406-F19-A2 Marking Scheme.pdf"}]},{"name":"Assignment #3 - Trivia Question Web Service","term":"Fall 2019","specfile":{"title":"COMP2406-F19-A3 Specification","url":"/assignments/fall2019/a3/COMP2406-F19-A3 Specification.pdf"},"resources":[{"title":"A3-Resources.zip","url":"/assignments/fall2019/a3/A3-Resources.zip"},{"title":"marking scheme.txt","url":"/assignments/fall2019/a3/marking scheme.txt"}]},{"name":"Assignment #4 - Trivia Quiz Builder Using MongoDB","term":"Fall 2019","specfile":{"title":"COMP2406-F19-A4 Specification","url":"/assignments/fall2019/a4/COMP2406-F19-A4 Specification.pdf"},"resources":[{"title":"database-initializer.js","url":"/assignments/fall2019/a4/database-initializer.js"},{"title":"COMP2406-F19-A4 Marking Scheme.txt","url":"/assignments/fall2019/a4/COMP2406-F19-A4 Marking Scheme.txt"}]},{"name":"Assignment #5 - Sessions and User Profiles","term":"Fall 2019","specfile":{"title":"COMP2406-F19-A5-Specification","url":"/assignments/fall2019/a5/COMP2406-F19-A5-Specification.pdf"},"resources":[{"title":"A5-BaseCode.zip","url":"/assignments/fall2019/a5/A5-BaseCode.zip"},{"title":"COMP2406-F19-A5 Marking Scheme.txt","url":"/assignments/fall2019/a5/COMP2406-F19-A5 Marking Scheme.txt"}]}]');var k;function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function A(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){D(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function D(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}k=JSON.parse('[{"name":"Tutorial 1","term":"Winter 2020","specfile":{"title":"COMP2406-W20-T01","url":"/tutorials/winter2020/t1/COMP2406-W20-T01.pdf"},"resources":[{"title":"stringproblems.js","url":"/tutorials/winter2020/t1/stringproblems.js"},{"title":"students.js","url":"/tutorials/winter2020/t1/students.js"}]},{"name":"Tutorial 2","term":"Winter 2020","specfile":{"title":"COMP2406-W20-T02.pdf","url":"/tutorials/winter2020/t2/COMP2406-W20-T02.pdf"}},{"name":"Tutorial 3","term":"Winter 2020","specfile":{"title":"COMP2406-W20-T3.pdf","url":"/tutorials/winter2020/t3/COMP2406-W20-T3.pdf"}},{"name":"Tutorial 4","term":"Winter 2020","specfile":{"title":"COMP2406-F19-T04","url":"/tutorials/winter2020/t4/COMP2406-F19-T04.pdf"},"resources":[{"title":"todo-server.zip","url":"/tutorials/winter2020/t4/todo-server.zip"}]},{"name":"Tutorial 5","term":"Winter 2020","specfile":{"title":"COMP2406-F20-T05","url":"/tutorials/winter2020/t5/COMP2406-F20-T05.pdf"},"resources":[{"title":"server.js","url":"/tutorials/winter2020/t5/server.js"},{"title":"cards.json","url":"/tutorials/winter2020/t5/cards.json"}]},{"name":"Tutorials 6 and 7","term":"Winter 2020","specfile":{"title":"COMP2406-W20-T0607","url":"/tutorials/winter2020/t6t7/COMP2406-W20-T0607.pdf"},"resources":[{"title":"T6-T7-BaseCode.zip","url":"/tutorials/winter2020/t6t7/T6-T7-BaseCode.zip"}]},{"name":"Tutorial 8","term":"Winter 2020","specfile":{"title":"COMP2406-W20-T08","url":"/tutorials/winter2020/t8/COMP2406-W20-T08.pdf"},"resources":[{"title":"T08-BaseCode.zip","url":"/tutorials/winter2020/t8/T08-BaseCode.zip"}]},{"name":"Tutorial 9","term":"Winter 2020","specfile":{"title":"COMP2406-W20-T09","url":"/tutorials/winter2020/t9/COMP2406-W20-T09.pdf"},"resources":[{"title":"T09-BaseCode.zip","url":"/tutorials/winter2020/t9/T09-BaseCode.zip"}]},{"name":"Tutorial 10","term":"Winter 2020","specfile":{"title":"COMP2406-W20-T10","url":"/tutorials/winter2020/t10/COMP2406-W20-T10.pdf"},"resources":[{"title":"T10-Base-Code.zip","url":"/tutorials/winter2020/t10/T10-Base-Code.zip"}]}]');var T=t(o),j=t(P),M=t(C),E=t(k),q={currentId:0,ready:!1,subscribers:[],init:function(){this.content=new T("courseWebsite.db",{persistenceMethod:"localStorage",autoload:!0,autoloadCallback:this.initalState.bind(this)})},initalState:function(){this.content.getCollection("lectures")||this.content.addCollection("lectures").insert(j),this.content.getCollection("assignments")||this.content.addCollection("assignments").insert(M),this.content.getCollection("tutorials")||this.content.addCollection("tutorials").insert(E),this.content.getCollection("forums")||this.content.addCollection("forums").insert([{title:"Announcements"},{title:"General"}]),this.content.getCollection("forumTopics")||this.content.addCollection("forumTopics"),this.content.getCollection("topicComments")||this.content.addCollection("topicComments"),this.content.saveDatabase(),this.ready=!0,this.notify()},subscribe:function(t){var e=this,n={id:this.currentId++,callback:t};return this.subscribers.push(n),function(){return e.unsubscribe(n.id)}},unsubscribe:function(t){this.subscribers=this.subscribers.filter((function(e){return e.id!==t}))},notify:function(){var t=this;window.setTimeout((function(){t.subscribers.forEach((function(t){return t.callback()}))}),1)},insertElement:function(t,e){var n=this.content.getCollection(t).insert(e);return this.content.saveDatabase(),this.notify(),n},deleteElement:function(t,e){this.content.getCollection(t).remove(e),this.content.saveDatabase(),this.notify()},getElement:function(t,e){return this.content.getCollection(t).get(e,!1)},getElements:function(t){return this.content.getCollection(t).data},addLecture:function(t){return this.insertElement("lectures",A(A({},j[0]),{},{unit:t}))},addAssignment:function(t){return this.insertElement("assignments",A(A({},M[0]),{},{name:t}))},addTutorial:function(t){return this.insertElement("tutorials",A(A({},E[0]),{},{name:t}))},deleteLecture:function(t){this.deleteElement("lectures",t)},deleteAssignment:function(t){this.deleteElement("assignments",t)},deleteTutorial:function(t){this.deleteElement("tutorials",t)},getLecture:function(t){return this.getElement("lectures",t)},getAssignment:function(t){return this.getElement("assignments",t)},getTutorial:function(t){return this.getElement("tutorials",t)},getLectures:function(){return this.getElements("lectures")},getAssignments:function(){return this.getElements("assignments")},getTutorials:function(){return this.getElements("tutorials")},addForumTopic:function(t,e,n,i){var r=this.insertElement("forumTopics",{forumId:t,title:e}),o=this.insertElement("topicComments",{topicId:r.$loki,user:n,content:i});return this.content.saveDatabase(),A(A({},r),{},{comments:[o]})},addTopicComment:function(t,e,n){var i=this.insertElement("topicComments",{topicId:t,user:e,content:n});return this.content.saveDatabase(),i},deleteForumTopic:function(t){this.deleteElement("forumTopics",t),this.content.getCollection("topicComments").removeWhere((function(e){return e.topicId===t.id})),this.content.saveDatabase()},deleteTopicComment:function(t){this.deleteElement("topicComments",t)},getForum:function(t){var e=this,n=this.getElement("forums",t);return n.topics=this.content.getCollection("forumTopics").find({forumId:n.$loki}).map((function(t){return A(A({},t),{},{comments:e.content.getCollection("topicComments").find({topicId:t.$loki})})})),n},getForumTopic:function(t){var e=this.getElement("forumTopics",t);return e.comments=this.content.getCollection("topicComments").find({topicId:e.$loki}),e},getForums:function(){var t=this;return this.getElements("forums").map((function(e){return A(A({},e),{},{topics:t.content.getCollection("forumTopics").find({forumId:e.$loki})})}))}};function R(t){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function N(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function z(t,e,n){return e&&_(t.prototype,e),n&&_(t,n),t}function $(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&W(t,e)}function W(t,e){return(W=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function F(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=B(t);if(e){var r=B(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return L(this,n)}}function L(t,e){return!e||"object"!==R(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function B(t){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}q.init();var J=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.HTMLElement;return function(t){$(n,t);var e=F(n);function n(){var t;return N(this,n),(t=e.call(this)).unsuscriber=null,t}return z(n,[{key:"connectedCallback",value:function(){this.isConnected&&(this.unsuscriber=q.subscribe(this.triggerNotified.bind(this))),q.ready&&this.render()}},{key:"disconnectedCallback",value:function(){this.unsuscriber&&this.unsuscriber()}},{key:"triggerNotified",value:function(){q.ready&&this.notified()}},{key:"notified",value:function(){}},{key:"render",value:function(){}}]),n}(t)},V=function(t){for(var e=window.location.pathname.substring(0,window.location.pathname.indexOf("/wc-course-website")),n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];switch(t){case"home":return"".concat(e,"/wc-course-website/index.html");case"lectures":return"".concat(e,"/wc-course-website/pages/lectures/index.html");case"lecture":var o=i[0];return"".concat(e,"/wc-course-website/pages/lecture/index.html?lecture=").concat(o);case"tutorials":return"".concat(e,"/wc-course-website/pages/tutorials/index.html");case"tutorial":var s=i[0];return"".concat(e,"/wc-course-website/pages/tutorial/index.html?tutorial=").concat(s);case"assignments":return"".concat(e,"/wc-course-website/pages/assignments/index.html");case"assignment":var a=i[0];return"".concat(e,"/wc-course-website/pages/assignment/index.html?assignment=").concat(a);case"forums":return"".concat(e,"/wc-course-website/pages/forums/index.html");case"forum":var l=i[0];return"".concat(e,"/wc-course-website/pages/forum/index.html?forum=").concat(l);case"topic":var c=i[0],u=i[1];return"".concat(e,"/wc-course-website/pages/forum/topic/index.html?forum=").concat(c,"&topic=").concat(u);default:throw new Error("Unknown type ".concat(t," given to the createUrl helper."))}};function H(t){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function K(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function U(t,e){return(U=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function G(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Q(t);if(e){var r=Q(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return X(this,n)}}function X(t,e){return!e||"object"!==H(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Q(t){return(Q=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&U(t,e)}(o,t);var e,n,i,r=G(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).navbarTemplateId="#navbar",t.navbarItemTemplateId="#navbar-item",t.navbarAddTemplateId="#navbar-add",t.navbarDividerTemplateId="#navbar-divider",t.unsuscriber=null,t}return e=o,(n=[{key:"notified",value:function(){this.render()}},{key:"render",value:function(){var t=q.getLectures(),e=q.getTutorials(),n=q.getAssignments(),i=q.getForums(),r=document.querySelector(this.navbarTemplateId).content,o=document.querySelector(this.navbarItemTemplateId).content,s=document.querySelector(this.navbarAddTemplateId).content,a=document.querySelector(this.navbarDividerTemplateId).content,l=r.cloneNode(!0),c=l.querySelector('[data-list="lectures"]');t.forEach((function(t){var e=o.cloneNode(!0),n=e.querySelector("a");n.href=V("lecture",t.$loki),n.innerText=t.unit,c.appendChild(e)})),c.appendChild(a.cloneNode(!0));var u=s.cloneNode(!0),h=u.querySelector("a");h.href="".concat(V("lectures"),"?new"),h.querySelector(".text").innerText="Add a new lecture",c.appendChild(u);var f=l.querySelector('[data-list="assignments"]');n.forEach((function(t){var e=o.cloneNode(!0),n=e.querySelector("a");n.href=V("assignment",t.$loki),n.innerText=t.name,f.appendChild(e)})),f.appendChild(a.cloneNode(!0));var d=s.cloneNode(!0),p=d.querySelector("a");p.href="".concat(V("assignments"),"?new"),p.querySelector(".text").innerText="Add a new assignment",f.appendChild(d);var y=l.querySelector('[data-list="tutorials"]');e.forEach((function(t){var e=o.cloneNode(!0),n=e.querySelector("a");n.href=V("tutorial",t.$loki),n.innerText=t.name,y.appendChild(e)})),y.appendChild(a.cloneNode(!0));var m=s.cloneNode(!0),g=m.querySelector("a");g.href="".concat(V("tutorials"),"?new"),g.querySelector(".text").innerText="Add a new tutorial",y.appendChild(m);var v=l.querySelector('[data-list="forums"]');i.forEach((function(t){var e=o.cloneNode(!0),n=e.querySelector("a");n.href=V("forum",t.$loki),n.innerText=t.title,v.appendChild(e)})),this.innerHTML="",this.appendChild(l)}}])&&K(e.prototype,n),i&&K(e,i),o}(J(window.HTMLElement));function Z(t){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function et(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function nt(t,e){return(nt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function it(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=ot(t);if(e){var r=ot(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return rt(this,n)}}function rt(t,e){return!e||"object"!==Z(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ot(t){return(ot=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}window.customElements.define("nav-bar",Y);var st=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nt(t,e)}(o,t);var e,n,i,r=it(o);function o(){return tt(this,o),r.apply(this,arguments)}return e=o,(n=[{key:"notified",value:function(){this.render()}},{key:"render",value:function(){var t=null,e=this.getAttribute("source");switch(e){case"lectures":t=document.createTextNode(q.getLectures().length);break;case"tutorials":t=document.createTextNode(q.getTutorials().length);break;case"assignments":t=document.createTextNode(q.getAssignments().length);break;case"forums":t=document.createTextNode(q.getForums().reduce((function(t,e){return t+e.topics.length}),0));break;default:throw new Error("Unknown course content type ".concat(e))}this.innerHTML="",this.appendChild(t)}}])&&et(e.prototype,n),i&&et(e,i),o}(J(window.HTMLElement));function at(t){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ct(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ut(t,e){return(ut=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ht(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=dt(t);if(e){var r=dt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ft(this,n)}}function ft(t,e){return!e||"object"!==at(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dt(t){return(dt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}window.customElements.define("content-count",st);var pt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ut(t,e)}(o,window.HTMLElement);var e,n,i,r=ht(o);function o(t){var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return lt(this,o),(e=r.call(this)).contentTemplateId=t,e.opened=n,e.render(),e}return e=o,(n=[{key:"toggle",value:function(){this.opened=!this.opened,this.update()}},{key:"update",value:function(){var t=this.querySelector('[data-element="inner"]');this.opened?(this.querySelector('[data-element="opened"]').style.display="block",this.querySelector('[data-element="closed"]').style.display="none",t.style.transition="max-height 1s ease-in-out",t.style["max-height"]="9000px",t.style["padding-bottom"]="20px"):(this.querySelector('[data-element="opened"]').style.display="none",this.querySelector('[data-element="closed"]').style.display="block",t.style.transition="max-height 0.5s cubic-bezier(0, 1, 0, 1)",t.style["max-height"]="0",t.style["padding-bottom"]="0")}},{key:"render",value:function(){var t=document.querySelector(this.contentTemplateId).content.cloneNode(!0),e=t.querySelector('[data-element="inner"]');t.querySelector('[data-element="icon-button"]').onclick=this.toggle.bind(this),e.innerHTML=this.innerHTML,this.innerHTML="",this.appendChild(t),this.update()}}])&&ct(e.prototype,n),i&&ct(e,i),o}();function yt(t){return(yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function gt(t,e,n){return(gt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ot(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function vt(t,e){return(vt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function bt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Ot(t);if(e){var r=Ot(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return wt(this,n)}}function wt(t,e){return!e||"object"!==yt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ot(t){return(Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var St=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vt(t,e)}(o,t);var e,n,i,r=bt(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,"#collapsible-content",!0)}return e=o,(n=[{key:"render",value:function(){gt(Ot(o.prototype),"render",this).call(this),this.querySelector('[data-element="title"]').innerText=this.getAttribute("title")}}])&&mt(e.prototype,n),i&&mt(e,i),o}(pt);function It(t){return(It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ct(t,e,n){return(Ct="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Dt(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function kt(t,e){return(kt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function xt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Dt(t);if(e){var r=Dt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return At(this,n)}}function At(t,e){return!e||"object"!==It(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Dt(t){return(Dt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}window.customElements.define("collapsible-content",St);var Tt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kt(t,e)}(o,t);var e,n,i,r=xt(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,"#collapsible-menu")}return e=o,(n=[{key:"render",value:function(){Ct(Dt(o.prototype),"render",this).call(this),this.querySelector('[data-element="title"]').innerText=this.getAttribute("title")}}])&&Pt(e.prototype,n),i&&Pt(e,i),o}(pt);function jt(t){return(jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Et(t,e){return(Et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function qt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Nt(t);if(e){var r=Nt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Rt(this,n)}}function Rt(t,e){return!e||"object"!==jt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Nt(t){return(Nt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}window.customElements.define("collapsible-menu",Tt);var _t=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Et(t,e)}(o,t);var e,n,i,r=qt(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).lectureTemplateId="#single-lecture",t.lectureData=null,t}return e=o,(n=[{key:"notified",value:function(){this.render()}},{key:"render",value:function(){this.classList.add("panel"),this.classList.add("is-primary");var t=null,e=new window.URL(window.location.toString());if(this.lectureData)t=this.lectureData;else{if(!e.searchParams.has("lecture"))return;var n=e.searchParams.get("lecture");t=q.getLecture(n)}if(t){var i=document.querySelector(this.lectureTemplateId).content.cloneNode(!0),r=i.querySelector('[data-element="title-link"]');r.href=V("lecture",t.$loki),r.innerText=t.unit;var o=this.getAttribute("delete-path");i.querySelector('[data-element="delete-button"]').onclick=function(){q.deleteLecture(t),o&&(window.location.href=o)};var s=i.querySelector('[data-list="slides"]').content;t.recordings&&t.slides.forEach((function(t){var e=s.cloneNode(!0);e.querySelector("div").appendChild(document.createTextNode(t.title)),i.appendChild(e)}));var a=i.querySelector('[data-list="recordings"]').content;t.recordings&&t.recordings.forEach((function(t){var e=a.cloneNode(!0);e.querySelector("div").appendChild(document.createTextNode(t.title)),i.appendChild(e)}));var l=i.querySelector('[data-list="code"]').content;t.code&&t.code.forEach((function(t){var e=l.cloneNode(!0);e.querySelector("div").appendChild(document.createTextNode(t.title)),i.appendChild(e)})),this.innerHTML="",this.appendChild(i)}}},{key:"lecture",set:function(t){this.lectureData=t,this.render()}}])&&Mt(e.prototype,n),i&&Mt(e,i),o}(J(window.HTMLDivElement));function zt(t){return(zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Wt(t,e){return(Wt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ft(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Bt(t);if(e){var r=Bt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Lt(this,n)}}function Lt(t,e){return!e||"object"!==zt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bt(t){return(Bt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}window.customElements.define("single-lecture",_t,{extends:"div"});var Jt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wt(t,e)}(o,t);var e,n,i,r=Ft(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).lecturesTemplateId="#lectures-list",t}return e=o,(n=[{key:"notified",value:function(){this.render()}},{key:"render",value:function(){var t=q.getLectures(),e=document.querySelector(this.lecturesTemplateId).content.cloneNode(!0),n=e.querySelector('[data-element="lectures"]');if(t.forEach((function(t){var e=new _t;e.lecture=t,n.appendChild(e)})),new window.URL(window.location.toString()).searchParams.has("new")){var i=function(){window.location.href=V("lectures")},r=e.querySelector('[data-element="new-modal"]');r.classList.add("is-active"),r.querySelector('[data-element="new-form"]').onsubmit=function(t){t.preventDefault();var e=t.target.querySelector("input").value,n=q.addLecture(e);window.location.href=V("lecture",n.$loki)},r.querySelector('[data-element="cancel-button"]').onclick=i,r.querySelector('[data-element="close-button"]').onclick=i}this.innerHTML="",this.appendChild(e)}}])&&$t(e.prototype,n),i&&$t(e,i),o}(J(window.HTMLElement));function Vt(t){return(Vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ht(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Kt(t,e){return(Kt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ut(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Xt(t);if(e){var r=Xt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Gt(this,n)}}function Gt(t,e){return!e||"object"!==Vt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xt(t){return(Xt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}window.customElements.define("lectures-list",Jt);var Qt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kt(t,e)}(o,t);var e,n,i,r=Ut(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).tutorialTemplateId="#single-tutorial",t.tutorialData=null,t}return e=o,(n=[{key:"notified",value:function(){this.render()}},{key:"render",value:function(){this.classList.add("panel"),this.classList.add("is-info");var t=null,e=new window.URL(window.location.toString());if(this.tutorialData)t=this.tutorialData;else{if(!e.searchParams.has("tutorial"))return;var n=e.searchParams.get("tutorial");t=q.getTutorials(n)}if(t){var i=document.querySelector(this.tutorialTemplateId).content.cloneNode(!0),r=i.querySelector('[data-element="title-link"]');r.href=V("tutorial",t.$loki),r.innerText=t.name;var o=this.getAttribute("delete-path");i.querySelector('[data-element="delete-button"]').onclick=function(){q.deleteTutorial(t),o&&(window.location.href=o)};var s=i.querySelector('[data-list="specfile"]').content;if(t.specfile){var a=s.cloneNode(!0);a.querySelector("div").appendChild(document.createTextNode(t.specfile.title)),i.appendChild(a)}var l=i.querySelector('[data-list="resources"]').content;t.resources&&t.resources.forEach((function(t){var e=l.cloneNode(!0);e.querySelector("div").appendChild(document.createTextNode(t.title)),i.appendChild(e)})),this.innerHTML="",this.appendChild(i)}}},{key:"tutorial",set:function(t){this.tutorialData=t,this.render()}}])&&Ht(e.prototype,n),i&&Ht(e,i),o}(J(window.HTMLDivElement));function Yt(t){return(Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function te(t,e){return(te=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ee(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=ie(t);if(e){var r=ie(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ne(this,n)}}function ne(t,e){return!e||"object"!==Yt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ie(t){return(ie=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}window.customElements.define("single-tutorial",Qt,{extends:"div"});var re=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&te(t,e)}(o,t);var e,n,i,r=ee(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).tutorialsTemplateId="#tutorials-list",t}return e=o,(n=[{key:"notified",value:function(){this.render()}},{key:"render",value:function(){var t=q.getTutorials(),e=document.querySelector(this.tutorialsTemplateId).content.cloneNode(!0),n=e.querySelector('[data-element="tutorials"]');if(t.forEach((function(t){var e=new Qt;e.tutorial=t,n.appendChild(e)})),new window.URL(window.location.toString()).searchParams.has("new")){var i=function(){window.location.href=V("tutorials")},r=e.querySelector('[data-element="new-modal"]');r.classList.add("is-active"),r.querySelector('[data-element="new-form"]').onsubmit=function(t){t.preventDefault();var e=t.target.querySelector("input").value,n=q.addTutorial(e);window.location.href=V("tutorial",n.$loki)},r.querySelector('[data-element="cancel-button"]').onclick=i,r.querySelector('[data-element="close-button"]').onclick=i}this.innerHTML="",this.appendChild(e)}}])&&Zt(e.prototype,n),i&&Zt(e,i),o}(J(window.HTMLElement));function oe(t){return(oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function se(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ae(t,e){return(ae=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function le(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=ue(t);if(e){var r=ue(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ce(this,n)}}function ce(t,e){return!e||"object"!==oe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ue(t){return(ue=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}window.customElements.define("tutorials-list",re);var he=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ae(t,e)}(o,t);var e,n,i,r=le(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).assignmentTemplateId="#single-assignment",t.assignmentData=null,t}return e=o,(n=[{key:"notified",value:function(){this.render()}},{key:"render",value:function(){this.classList.add("panel"),this.classList.add("is-success");var t=null,e=new window.URL(window.location.toString());if(this.assignmentData)t=this.assignmentData;else{if(!e.searchParams.has("assignment"))return;var n=e.searchParams.get("assignment");t=q.getAssignment(n)}if(t){var i=document.querySelector(this.assignmentTemplateId).content.cloneNode(!0),r=i.querySelector('[data-element="title-link"]');r.href=V("assignment",t.$loki),r.innerText=t.name;var o=this.getAttribute("delete-path");i.querySelector('[data-element="delete-button"]').onclick=function(){q.deleteAssignment(t),o&&(window.location.href=o)};var s=i.querySelector('[data-list="specfile"]').content;if(t.specfile){var a=s.cloneNode(!0);a.querySelector("div").appendChild(document.createTextNode(t.specfile.title)),i.appendChild(a)}var l=i.querySelector('[data-list="resources"]').content;t.resources&&t.resources.forEach((function(t){var e=l.cloneNode(!0);e.querySelector("div").appendChild(document.createTextNode(t.title)),i.appendChild(e)})),this.innerHTML="",this.appendChild(i)}}},{key:"assignment",set:function(t){this.assignmentData=t,this.render()}}])&&se(e.prototype,n),i&&se(e,i),o}(J(window.HTMLDivElement));function fe(t){return(fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function de(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function pe(t,e){return(pe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ye(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=ge(t);if(e){var r=ge(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return me(this,n)}}function me(t,e){return!e||"object"!==fe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ge(t){return(ge=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}window.customElements.define("single-assignment",he,{extends:"div"});var ve=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pe(t,e)}(o,t);var e,n,i,r=ye(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).assignmentsTemplateId="#assignments-list",t}return e=o,(n=[{key:"notified",value:function(){this.render()}},{key:"render",value:function(){var t=q.getAssignments(),e=document.querySelector(this.assignmentsTemplateId).content.cloneNode(!0),n=e.querySelector('[data-element="assignments"]');if(t.forEach((function(t){var e=new he;e.assignment=t,n.appendChild(e)})),new window.URL(window.location.toString()).searchParams.has("new")){var i=function(){window.location.href=V("assignments")},r=e.querySelector('[data-element="new-modal"]');r.classList.add("is-active"),r.querySelector('[data-element="new-form"]').onsubmit=function(t){t.preventDefault();var e=t.target.querySelector("input").value,n=q.addAssignment(e);window.location.href=V("assignment",n.$loki)},r.querySelector('[data-element="cancel-button"]').onclick=i,r.querySelector('[data-element="close-button"]').onclick=i}this.innerHTML="",this.appendChild(e)}}])&&de(e.prototype,n),i&&de(e,i),o}(J(window.HTMLElement));function be(t){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function we(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Oe(t,e){return(Oe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Se(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Pe(t);if(e){var r=Pe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Ie(this,n)}}function Ie(t,e){return!e||"object"!==be(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pe(t){return(Pe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}window.customElements.define("assignments-list",ve);var Ce=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oe(t,e)}(o,t);var e,n,i,r=Se(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).forumsTemplateId="#forums-list",t}return e=o,(n=[{key:"notified",value:function(){this.render()}},{key:"render",value:function(){var t=q.getForums(),e=document.querySelector(this.forumsTemplateId).content.cloneNode(!0),n=e.querySelector('[data-element="forums"]'),i=e.querySelector('[data-element="single-forum"]').content;t.forEach((function(t){var e=i.cloneNode(!0),r=e.querySelector('[data-element="title"]');r.href=V("forum",t.$loki),r.innerText="".concat(t.title," - ").concat(t.topics.length," topics"),n.appendChild(e)})),this.innerHTML="",this.appendChild(e)}}])&&we(e.prototype,n),i&&we(e,i),o}(J(window.HTMLElement));function ke(t){return(ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ae(t,e){return(Ae=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function De(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=je(t);if(e){var r=je(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Te(this,n)}}function Te(t,e){return!e||"object"!==ke(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function je(t){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}window.customElements.define("forums-list",Ce);var Me=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ae(t,e)}(o,t);var e,n,i,r=De(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).activitiesTemplateId="#activities",t}return e=o,(n=[{key:"notified",value:function(){this.render()}},{key:"render",value:function(){var t=q.getLectures(),e=q.getTutorials(),n=q.getTutorials(),i=q.getForums(),r=document.querySelector(this.activitiesTemplateId).content.cloneNode(!0),o=r.querySelector('[data-element="single-lecture"]').content;t.forEach((function(t){var e=o.cloneNode(!0),n=e.querySelector('[data-element="title"]');n.href=V("lecture",t.$loki),n.innerText=t.unit,r.querySelector('[data-list="lectures"]').appendChild(e)}));var s=r.querySelector('[data-element="single-tutorial"]').content;n.forEach((function(t){var e=s.cloneNode(!0),n=e.querySelector('[data-element="title"]');n.href=V("tutorial",t.$loki),n.innerText=t.name,r.querySelector('[data-list="tutorials"]').appendChild(e)}));var a=r.querySelector('[data-element="single-assignment"]').content;e.forEach((function(t){var e=a.cloneNode(!0),n=e.querySelector('[data-element="title"]');n.href=V("assignment",t.$loki),n.innerText=t.name,r.querySelector('[data-list="assignments"]').appendChild(e)}));var l=r.querySelector('[data-element="single-forum"]').content;i.forEach((function(t){var e=l.cloneNode(!0),n=e.querySelector('[data-element="title"]');n.href=V("forum",t.$loki),n.innerText=t.title,e.querySelector('[data-element="topic-count"]').innerText=t.topics.length,r.querySelector('[data-list="forums"]').appendChild(e)})),this.innerHTML="",this.appendChild(r)}}])&&xe(e.prototype,n),i&&xe(e,i),o}(J(window.HTMLElement));window.customElements.define("activities-aside",Me)}();
//# sourceMappingURL=wc-course-website.201ffebe.js.map
