!function(){var t=parcelRequire("7efb332d8ccb9a6b3f962ac63aa3525c"),e=parcelRequire("8dc4bd82eadd83b135ac82ece8b7911c"),n=parcelRequire("b2736226bbcf175e104b7e710aa92180");var r,o,a={};!function(t){function e(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function n(t,n,r,o,a,c){return e((u=e(e(n,t),e(o,c)))<<(i=a)|u>>>32-i,r);var u,i}function r(t,e,r,o,a,c,u){return n(e&r|~e&o,t,e,a,c,u)}function o(t,e,r,o,a,c,u){return n(e&o|r&~o,t,e,a,c,u)}function c(t,e,r,o,a,c,u){return n(e^r^o,t,e,a,c,u)}function u(t,e,r,o,a,c,u){return n(r^(e|~o),t,e,a,c,u)}function i(t,n){var a,i,l,f,s;t[n>>5]|=128<<n%32,t[14+(n+64>>>9<<4)]=n;var p=1732584193,m=-271733879,d=-1732584194,y=271733878;for(a=0;a<t.length;a+=16)i=p,l=m,f=d,s=y,p=r(p,m,d,y,t[a],7,-680876936),y=r(y,p,m,d,t[a+1],12,-389564586),d=r(d,y,p,m,t[a+2],17,606105819),m=r(m,d,y,p,t[a+3],22,-1044525330),p=r(p,m,d,y,t[a+4],7,-176418897),y=r(y,p,m,d,t[a+5],12,1200080426),d=r(d,y,p,m,t[a+6],17,-1473231341),m=r(m,d,y,p,t[a+7],22,-45705983),p=r(p,m,d,y,t[a+8],7,1770035416),y=r(y,p,m,d,t[a+9],12,-1958414417),d=r(d,y,p,m,t[a+10],17,-42063),m=r(m,d,y,p,t[a+11],22,-1990404162),p=r(p,m,d,y,t[a+12],7,1804603682),y=r(y,p,m,d,t[a+13],12,-40341101),d=r(d,y,p,m,t[a+14],17,-1502002290),p=o(p,m=r(m,d,y,p,t[a+15],22,1236535329),d,y,t[a+1],5,-165796510),y=o(y,p,m,d,t[a+6],9,-1069501632),d=o(d,y,p,m,t[a+11],14,643717713),m=o(m,d,y,p,t[a],20,-373897302),p=o(p,m,d,y,t[a+5],5,-701558691),y=o(y,p,m,d,t[a+10],9,38016083),d=o(d,y,p,m,t[a+15],14,-660478335),m=o(m,d,y,p,t[a+4],20,-405537848),p=o(p,m,d,y,t[a+9],5,568446438),y=o(y,p,m,d,t[a+14],9,-1019803690),d=o(d,y,p,m,t[a+3],14,-187363961),m=o(m,d,y,p,t[a+8],20,1163531501),p=o(p,m,d,y,t[a+13],5,-1444681467),y=o(y,p,m,d,t[a+2],9,-51403784),d=o(d,y,p,m,t[a+7],14,1735328473),p=c(p,m=o(m,d,y,p,t[a+12],20,-1926607734),d,y,t[a+5],4,-378558),y=c(y,p,m,d,t[a+8],11,-2022574463),d=c(d,y,p,m,t[a+11],16,1839030562),m=c(m,d,y,p,t[a+14],23,-35309556),p=c(p,m,d,y,t[a+1],4,-1530992060),y=c(y,p,m,d,t[a+4],11,1272893353),d=c(d,y,p,m,t[a+7],16,-155497632),m=c(m,d,y,p,t[a+10],23,-1094730640),p=c(p,m,d,y,t[a+13],4,681279174),y=c(y,p,m,d,t[a],11,-358537222),d=c(d,y,p,m,t[a+3],16,-722521979),m=c(m,d,y,p,t[a+6],23,76029189),p=c(p,m,d,y,t[a+9],4,-640364487),y=c(y,p,m,d,t[a+12],11,-421815835),d=c(d,y,p,m,t[a+15],16,530742520),p=u(p,m=c(m,d,y,p,t[a+2],23,-995338651),d,y,t[a],6,-198630844),y=u(y,p,m,d,t[a+7],10,1126891415),d=u(d,y,p,m,t[a+14],15,-1416354905),m=u(m,d,y,p,t[a+5],21,-57434055),p=u(p,m,d,y,t[a+12],6,1700485571),y=u(y,p,m,d,t[a+3],10,-1894986606),d=u(d,y,p,m,t[a+10],15,-1051523),m=u(m,d,y,p,t[a+1],21,-2054922799),p=u(p,m,d,y,t[a+8],6,1873313359),y=u(y,p,m,d,t[a+15],10,-30611744),d=u(d,y,p,m,t[a+6],15,-1560198380),m=u(m,d,y,p,t[a+13],21,1309151649),p=u(p,m,d,y,t[a+4],6,-145523070),y=u(y,p,m,d,t[a+11],10,-1120210379),d=u(d,y,p,m,t[a+2],15,718787259),m=u(m,d,y,p,t[a+9],21,-343485551),p=e(p,i),m=e(m,l),d=e(d,f),y=e(y,s);return[p,m,d,y]}function l(t){var e,n="",r=32*t.length;for(e=0;e<r;e+=8)n+=String.fromCharCode(t[e>>5]>>>e%32&255);return n}function f(t){var e,n=[];for(n[(t.length>>2)-1]=void 0,e=0;e<n.length;e+=1)n[e]=0;var r=8*t.length;for(e=0;e<r;e+=8)n[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return n}function s(t){var e,n,r="";for(n=0;n<t.length;n+=1)e=t.charCodeAt(n),r+="0123456789abcdef".charAt(e>>>4&15)+"0123456789abcdef".charAt(15&e);return r}function p(t){return unescape(encodeURIComponent(t))}function m(t){return function(t){return l(i(f(t),8*t.length))}(p(t))}function d(t,e){return function(t,e){var n,r,o=f(t),a=[],c=[];for(a[15]=c[15]=void 0,o.length>16&&(o=i(o,8*t.length)),n=0;n<16;n+=1)a[n]=909522486^o[n],c[n]=1549556828^o[n];return r=i(a.concat(f(e)),512+8*e.length),l(i(c.concat(r),640))}(p(t),p(e))}function y(t,e,n){return e?n?d(e,t):s(d(e,t)):n?m(t):s(m(t))}a?a=y:t.md5=y}(a);var c;function u(t,e){return Object.prototype.hasOwnProperty.call(t,e)}c=function(t,e,n,r){e=e||"&",n=n||"=";var o={};if("string"!=typeof t||0===t.length)return o;var a=/\+/g;t=t.split(e);var c=1e3;r&&"number"==typeof r.maxKeys&&(c=r.maxKeys);var i=t.length;c>0&&i>c&&(i=c);for(var f=0;f<i;++f){var s,p,m,d,y=t[f].replace(a,"%20"),h=y.indexOf(n);h>=0?(s=y.substr(0,h),p=y.substr(h+1)):(s=y,p=""),m=decodeURIComponent(s),d=decodeURIComponent(p),u(o,m)?l(o[m])?o[m].push(d):o[m]=[o[m],d]:o[m]=d}return o};var i,l=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},f=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};i=function(t,e,n,r){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?p(m(t),(function(r){var o=encodeURIComponent(f(r))+n;return s(t[r])?p(t[r],(function(t){return o+encodeURIComponent(f(t))})).join(e):o+encodeURIComponent(f(t[r]))})).join(e):r?encodeURIComponent(f(r))+n+encodeURIComponent(f(t)):""};var s=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function p(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var m=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e},d=(o=i,/^[0-9a-f]{32}$/);function y(t,e){if(t)return"boolean"==typeof t.protocol?t.protocol:"http"!==t.protocol&&("https"===t.protocol||void 0)}function h(t){return(t="string"==typeof t?t.trim().toLowerCase():"unspecified").match(d)?t:a(t)}function v(t){var e=o(function(t){var e={},n={protocol:1,format:1};for(var r in t)n[r]||(e[r]=t[r]);return e}(t));return e&&"?"+e||""}r={url:function(t,e,n){var r="//www.gravatar.com/avatar/";e&&e.cdn?(r=e.cdn+"/avatar/",delete e.cdn):(e&&e.protocol&&(n=y(e)),void 0!==n&&(r=n?"https://s.gravatar.com/avatar/":"http://www.gravatar.com/avatar/"));var o=v(e);return r+h(t)+o},profile_url:function(t,e,n){var r=null!=e&&null!=e.format?String(e.format):"json";if(e&&e.cdn)o=e.cdn+"/",delete e.cdn;else{e&&e.protocol&&(n=y(e));var o=n?"https://secure.gravatar.com/":"http://www.gravatar.com/"}var a=v(e);return o+h(t)+"."+r+a}};var b,g=(b=r)&&b.__esModule?b.default:b,w=[{name:"admin",role:"admin",email:"admin@carleton.ca",avatar:g.url("admin@carleton.ca",{s:"200",r:"pg",d:"identicon"})},{name:"student",role:"student",email:"student@carleton.ca",avatar:g.url("student@carleton.ca",{s:"200",r:"pg",d:"identicon"})}],S=function(t){return w.find((function(e){return e.name===t}))};function O(t){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function j(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function R(t,e){return(R=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function T(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=k(t);if(e){var o=k(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return C(this,n)}}function C(t,e){return!e||"object"!==O(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function k(t){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var _=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&R(t,e)}(c,t);var e,r,o,a=T(c);function c(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(t=a.call(this)).forumTopicTemplateId="#forum-topic",t}return e=c,(r=[{key:"notified",value:function(){this.render()}},{key:"render",value:function(){var t=null,e=new window.URL(window.location.toString());if(e.searchParams.has("topic")){t=e.searchParams.get("topic");var r=n().databaseManager.getForumTopic(t),o=document.querySelector(this.forumTopicTemplateId).content.cloneNode(!0),a=r.comments[0],c=S(a.user),u=o.querySelector('[data-element="author-avatar"]');u.src=c.avatar,u.alt=c.name,o.querySelector('[data-element="title"]').innerText=r.title,o.querySelector('[data-element="author-name"]').innerText=c.name,o.querySelector('[data-element="author-email"]').innerText=c.email;var i=o.querySelector('[data-element="content"]');a.content.split("\n").forEach((function(t){var e=document.createElement("p");e.innerHTML=t,i.prepend(e)}));var l=o.querySelector('[data-element="thread"]');r.comments.slice(1).forEach((function(t){var e=o.querySelector('[data-element="comment"]').content.cloneNode(!0),r=S(t.user),a=e.querySelector('[data-element="author-avatar"]');a.src=r.avatar,a.alt=r.name,e.querySelector('[data-element="author-name"]').innerText=r.name,e.querySelector('[data-element="author-email"]').innerText=r.email;var c=e.querySelector('[data-element="content"]');t.content.split("\n").forEach((function(t){var e=document.createElement("p");e.innerHTML=t,c.prepend(e)})),e.querySelector('[data-element="delete-button"]').onclick=function(){n().databaseManager.deleteTopicComment(t)},l.appendChild(e)})),o.querySelector('[data-element="new-comment"]').onsubmit=function(t){t.preventDefault();var e=t.target.querySelector('[data-element="topic-content"]').value;n().databaseManager.addTopicComment(r.$loki,w[0].name,e)},this.innerHTML="",this.appendChild(o)}}}])&&j(e.prototype,r),o&&j(e,o),c}(e().DatabaseConsumer(window.HTMLElement));function q(t){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function P(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function E(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function I(t,e){return(I=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function M(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=A(t);if(e){var o=A(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return U(this,n)}}function U(t,e){return!e||"object"!==q(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function A(t){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}window.customElements.define("forum-topic",_);var x=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&I(t,e)}(u,e);var r,o,a,c=M(u);function u(){return P(this,u),c.apply(this,arguments)}return r=u,(o=[{key:"notified",value:function(){this.render()}},{key:"getId",value:function(t){var e=new window.URL(window.location.toString());return this.hasAttribute("element-id")?this.getAttribute("element-id"):e.searchParams.has(t)?parseInt(e.searchParams.get(t)):-1}},{key:"render",value:function(){var e=null,r=this.getAttribute("source");switch(r){case"lectures":e=t().createUrl("lecture",n().databaseManager.getLecture(this.getId("lecture")).$loki);break;case"tutorials":e=t().createUrl("tutorial",n().databaseManager.getTutorial(this.getId("tutorial")).$loki);break;case"assignments":e=t().createUrl("assignment",n().databaseManager.getAssignment(this.getId("assignment")).$loki);break;case"forums":e=t().createUrl("forum",n().databaseManager.getForum(this.getId("forum")).$loki);break;default:throw new Error("Unknown course content type ".concat(r))}this.innerHTML='<a href="'.concat(e,'">').concat(this.innerHTML,"</a>")}}])&&E(r.prototype,o),a&&E(r,a),u}(e().DatabaseConsumer(window.HTMLElement));window.customElements.define("content-link",x)}();
//# sourceMappingURL=topic.b3bca7a9.js.map
